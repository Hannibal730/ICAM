2026-02-27 00:26:40,572 - INFO - 로그 파일이 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/log_20260227_002640.log'에 저장됩니다.
2026-02-27 00:26:40,573 - INFO - 전역 랜덤 시드를 42로 고정합니다.
2026-02-27 00:26:40,576 - INFO - ==================================================
2026-02-27 00:26:40,576 - INFO - config.yaml:
2026-02-27 00:26:40,576 - INFO - 
run:
  global_seed: 42
  cuda: true
  mode: train
  pth_best_name: best_model.pth
  only_inference: false
  show_log: true
  dataset:
    name: Sewer_TAPNEW
    type: image_folder
    train_split_ratio: 0.8
    paths:
      train_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/train
      valid_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      test_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      train_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Train.csv
      valid_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      test_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      img_folder: /home/tai/workspace/ssd1/data/Sewer/Sewer-TAPNEW
  random_sampling_ratio:
    train: 1.0
    valid: 1.0
    test: 1.0
  num_workers: 16
model:
  img_size: 224
  num_patches_per_side: 7
  num_decoder_patches: 7
  num_decoder_layers: 6
  num_heads: 4
  cnn_feature_extractor:
    name: custom32
  encoder_dim: 32
  emb_dim: 32
  adaptive_initial_query: true
  decoder_ff_ratio: 2
  dropout: 0.1
  positional_encoding: true
  drop_path_ratio: 0.2
  visualize_attention: true
  num_plot_attention: 1500
training_main:
  epochs: 10
  batch_size: 16
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 10
    eta_min: 0.0001
  best_model_criterion: val_loss
training_baseline:
  model_name: mobilenet_v4_s
  epochs: 10
  batch_size: 16
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 10
    eta_min: 0.0001
  best_model_criterion: val_loss
finetuning_pruned:
  epochs: 80
  batch_size: 16
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 80
    eta_min: 0.0001
  best_model_criterion: val_loss
  use_wanda_pruning: true
  num_wanda_calib_samples: 1353
  pruning_sparsity: 0.5
  exclude_attention_qkv_pruning: true
  exclude_embedding_bridge_pruning: true
  exclude_learnable_queries_pruning: true

2026-02-27 00:26:40,577 - INFO - ==================================================
2026-02-27 00:26:40,608 - INFO - CUDA 사용 가능. GPU 사용을 시작합니다. (Device: NVIDIA GeForce RTX 5090)
2026-02-27 00:26:40,609 - INFO - 'Sewer_TAPNEW' 데이터 로드를 시작합니다 (Type: image_folder).
2026-02-27 00:26:40,609 - INFO - '/home/tai/workspace/ssd1/data/Sewer/Sewer-TAPNEW' 경로의 데이터를 훈련/테스트셋으로 분할합니다.
2026-02-27 00:26:40,614 - INFO - 총 1692개 데이터를 훈련용 1353개, 테스트용 339개로 분할합니다 (split_seed=42).
2026-02-27 00:26:40,615 - INFO - 데이터셋 클래스: ['abnormal', 'normal'] (총 2개)
2026-02-27 00:26:40,615 - INFO - 훈련 데이터: 1353개, 검증 데이터: 339개, 테스트 데이터: 339개
2026-02-27 00:26:40,615 - INFO - 이미지 크기: 224, 그리드 크기: 7x7 -> 인코더 패치 수: 49개
2026-02-27 00:26:40,784 - INFO - ==================================================
2026-02-27 00:26:40,784 - INFO - 모델 파라미터 수: 91,138 개
2026-02-27 00:26:40,784 - INFO -   - Encoder (Encoder):         22,656 개
2026-02-27 00:26:40,784 - INFO -     - conv_front (CNN Backbone):        22,592 개
2026-02-27 00:26:40,784 - INFO -     - 1x1_conv (Channel Proj):          0 개
2026-02-27 00:26:40,784 - INFO -     - norm (LayerNorm):                 64 개
2026-02-27 00:26:40,784 - INFO -   - Decoder (Cross-Attention-based):    53,504 개
2026-02-27 00:26:40,784 - INFO -     - Embedding Layer (feat_to_emb):   1,056 개
2026-02-27 00:26:40,784 - INFO -     - Init Key Proj (W_K_init):         1,056 개
2026-02-27 00:26:40,784 - INFO -     - Init Value Proj (W_V_init):       1,056 개
2026-02-27 00:26:40,784 - INFO -     - Learnable Queries:                224 개
2026-02-27 00:26:40,784 - INFO -     - Decoder Layers:                   50,112 개
2026-02-27 00:26:40,784 - INFO -   - Classifier (Projection MLP):        14,978 개
2026-02-27 00:26:40,784 - INFO - ================================================================================
2026-02-27 00:26:40,784 - INFO - 단계 1/2: training_main 기반 사전 훈련(Pre-training)을 시작합니다.
2026-02-27 00:26:40,784 - INFO - ================================================================================
2026-02-27 00:26:40,784 - INFO - 옵티마이저: AdamW (lr=0.001, weight_decay=0.0001)
2026-02-27 00:26:40,785 - INFO - 스케줄러: CosineAnnealingLR (T_max=10, eta_min=0.0001)
2026-02-27 00:26:40,796 - INFO - ==================================================
2026-02-27 00:26:40,796 - INFO - train 모드를 시작합니다.
2026-02-27 00:26:40,796 - INFO - 손실 함수: CrossEntropyLoss (label_smoothing: 0.1)
2026-02-27 00:26:40,796 - INFO - --------------------------------------------------
2026-02-27 00:26:40,796 - INFO - [LR]    [1/10] | Learning Rate: 0.001000
2026-02-27 00:26:45,276 - INFO - [Train] [1/10] | Loss: 0.5474 | Train Acc: 75.67%
2026-02-27 00:26:46,809 - INFO - [Valid] [1/10] | Loss: 0.5731 | Val Acc: 72.57%
2026-02-27 00:26:46,813 - INFO - [Metrics for 'abnormal'] | Precision: 0.6455 | Recall: 0.9045 | F1: 0.7533
2026-02-27 00:26:46,813 - INFO - [Metrics for 'normal'] | Precision: 0.8739 | Recall: 0.5714 | F1: 0.6910
2026-02-27 00:26:46,821 - INFO - [Best Model Saved] (val loss: 0.5731) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:26:46,821 - INFO - --------------------------------------------------
2026-02-27 00:26:46,821 - INFO - [LR]    [2/10] | Learning Rate: 0.000978
2026-02-27 00:26:50,592 - INFO - [Train] [2/10] | Loss: 0.5040 | Train Acc: 79.91%
2026-02-27 00:26:51,486 - INFO - [Valid] [2/10] | Loss: 0.5243 | Val Acc: 76.11%
2026-02-27 00:26:51,494 - INFO - [Metrics for 'abnormal'] | Precision: 0.7159 | Recall: 0.8025 | F1: 0.7568
2026-02-27 00:26:51,494 - INFO - [Metrics for 'normal'] | Precision: 0.8098 | Recall: 0.7253 | F1: 0.7652
2026-02-27 00:26:51,502 - INFO - [Best Model Saved] (val loss: 0.5243) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:26:51,503 - INFO - --------------------------------------------------
2026-02-27 00:26:51,503 - INFO - [LR]    [3/10] | Learning Rate: 0.000914
2026-02-27 00:26:55,476 - INFO - [Train] [3/10] | Loss: 0.4990 | Train Acc: 79.02%
2026-02-27 00:26:56,615 - INFO - [Valid] [3/10] | Loss: 0.4963 | Val Acc: 81.12%
2026-02-27 00:26:56,619 - INFO - [Metrics for 'abnormal'] | Precision: 0.7719 | Recall: 0.8408 | F1: 0.8049
2026-02-27 00:26:56,619 - INFO - [Metrics for 'normal'] | Precision: 0.8512 | Recall: 0.7857 | F1: 0.8171
2026-02-27 00:26:56,628 - INFO - [Best Model Saved] (val loss: 0.4963) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:26:56,628 - INFO - --------------------------------------------------
2026-02-27 00:26:56,628 - INFO - [LR]    [4/10] | Learning Rate: 0.000815
2026-02-27 00:27:01,206 - INFO - [Train] [4/10] | Loss: 0.4810 | Train Acc: 80.95%
2026-02-27 00:27:02,476 - INFO - [Valid] [4/10] | Loss: 0.5312 | Val Acc: 76.99%
2026-02-27 00:27:02,480 - INFO - [Metrics for 'abnormal'] | Precision: 0.7651 | Recall: 0.7261 | F1: 0.7451
2026-02-27 00:27:02,480 - INFO - [Metrics for 'normal'] | Precision: 0.7737 | Recall: 0.8077 | F1: 0.7903
2026-02-27 00:27:02,481 - INFO - --------------------------------------------------
2026-02-27 00:27:02,481 - INFO - [LR]    [5/10] | Learning Rate: 0.000689
2026-02-27 00:27:06,912 - INFO - [Train] [5/10] | Loss: 0.4640 | Train Acc: 84.08%
2026-02-27 00:27:08,253 - INFO - [Valid] [5/10] | Loss: 0.4871 | Val Acc: 80.83%
2026-02-27 00:27:08,256 - INFO - [Metrics for 'abnormal'] | Precision: 0.8067 | Recall: 0.7707 | F1: 0.7883
2026-02-27 00:27:08,256 - INFO - [Metrics for 'normal'] | Precision: 0.8095 | Recall: 0.8407 | F1: 0.8248
2026-02-27 00:27:08,261 - INFO - [Best Model Saved] (val loss: 0.4871) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:08,261 - INFO - --------------------------------------------------
2026-02-27 00:27:08,261 - INFO - [LR]    [6/10] | Learning Rate: 0.000550
2026-02-27 00:27:12,990 - INFO - [Train] [6/10] | Loss: 0.4618 | Train Acc: 83.18%
2026-02-27 00:27:14,157 - INFO - [Valid] [6/10] | Loss: 0.4692 | Val Acc: 81.42%
2026-02-27 00:27:14,160 - INFO - [Metrics for 'abnormal'] | Precision: 0.8456 | Recall: 0.7325 | F1: 0.7850
2026-02-27 00:27:14,160 - INFO - [Metrics for 'normal'] | Precision: 0.7931 | Recall: 0.8846 | F1: 0.8364
2026-02-27 00:27:14,169 - INFO - [Best Model Saved] (val loss: 0.4692) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:14,169 - INFO - --------------------------------------------------
2026-02-27 00:27:14,169 - INFO - [LR]    [7/10] | Learning Rate: 0.000411
2026-02-27 00:27:19,051 - INFO - [Train] [7/10] | Loss: 0.4514 | Train Acc: 83.26%
2026-02-27 00:27:20,028 - INFO - [Valid] [7/10] | Loss: 0.4643 | Val Acc: 83.78%
2026-02-27 00:27:20,032 - INFO - [Metrics for 'abnormal'] | Precision: 0.8446 | Recall: 0.7962 | F1: 0.8197
2026-02-27 00:27:20,033 - INFO - [Metrics for 'normal'] | Precision: 0.8325 | Recall: 0.8736 | F1: 0.8525
2026-02-27 00:27:20,042 - INFO - [Best Model Saved] (val loss: 0.4643) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:20,043 - INFO - --------------------------------------------------
2026-02-27 00:27:20,043 - INFO - [LR]    [8/10] | Learning Rate: 0.000285
2026-02-27 00:27:25,186 - INFO - [Train] [8/10] | Loss: 0.4398 | Train Acc: 83.33%
2026-02-27 00:27:26,288 - INFO - [Valid] [8/10] | Loss: 0.4691 | Val Acc: 81.42%
2026-02-27 00:27:26,295 - INFO - [Metrics for 'abnormal'] | Precision: 0.8264 | Recall: 0.7580 | F1: 0.7907
2026-02-27 00:27:26,295 - INFO - [Metrics for 'normal'] | Precision: 0.8051 | Recall: 0.8626 | F1: 0.8329
2026-02-27 00:27:26,298 - INFO - --------------------------------------------------
2026-02-27 00:27:26,298 - INFO - [LR]    [9/10] | Learning Rate: 0.000186
2026-02-27 00:27:31,121 - INFO - [Train] [9/10] | Loss: 0.4376 | Train Acc: 84.67%
2026-02-27 00:27:32,207 - INFO - [Valid] [9/10] | Loss: 0.4545 | Val Acc: 83.48%
2026-02-27 00:27:32,218 - INFO - [Metrics for 'abnormal'] | Precision: 0.8344 | Recall: 0.8025 | F1: 0.8182
2026-02-27 00:27:32,218 - INFO - [Metrics for 'normal'] | Precision: 0.8351 | Recall: 0.8626 | F1: 0.8486
2026-02-27 00:27:32,233 - INFO - [Best Model Saved] (val loss: 0.4545) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:32,236 - INFO - --------------------------------------------------
2026-02-27 00:27:32,236 - INFO - [LR]    [10/10] | Learning Rate: 0.000122
2026-02-27 00:27:36,532 - INFO - [Train] [10/10] | Loss: 0.4340 | Train Acc: 85.04%
2026-02-27 00:27:37,728 - INFO - [Valid] [10/10] | Loss: 0.4655 | Val Acc: 83.19%
2026-02-27 00:27:37,733 - INFO - [Metrics for 'abnormal'] | Precision: 0.8378 | Recall: 0.7898 | F1: 0.8131
2026-02-27 00:27:37,733 - INFO - [Metrics for 'normal'] | Precision: 0.8272 | Recall: 0.8681 | F1: 0.8472
2026-02-27 00:27:37,734 - INFO - ================================================================================
2026-02-27 00:27:37,734 - INFO - 단계 2/2: Pruning 및 finetuning_pruned 기반 미세 조정을 시작합니다.
2026-02-27 00:27:37,734 - INFO - ================================================================================
2026-02-27 00:27:37,784 - INFO - 사전 훈련된 모델 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'을(를) 불러왔습니다.
2026-02-27 00:27:37,784 - INFO - ICAM Pruning 정책: full_model (encoder+decoder+classifier 대상, 마지막 분류층/attention qkv/embedding bridge/learnable queries 제외). ignored_layers=23
2026-02-27 00:27:37,785 - INFO - Wanda Pruning을 시작합니다.
2026-02-27 00:27:37,785 - INFO - Wanda 중요도 계산을 위해 Calibration을 수행합니다.
2026-02-27 00:27:37,787 - INFO -   - Calibration Samples: 1353 (approx 85 batches)
2026-02-27 00:27:41,940 - INFO - 분류 레이어 'Linear'을(를) Pruning 대상에서 제외합니다.
2026-02-27 00:27:42,334 - INFO - torch-pruning 완료. 모델 구조가 희소도(0.5)에 맞춰 변경되었습니다.
2026-02-27 00:27:42,335 - INFO - ==================================================
2026-02-27 00:27:42,361 - INFO - Pruning 정보(희소도: 0.5000)를 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/pruning_info.yaml'에 저장했습니다.
2026-02-27 00:27:42,362 - INFO - ==================================================
2026-02-27 00:27:42,362 - INFO - 모델 파라미터 수: 55,394 개
2026-02-27 00:27:42,362 - INFO -   - Encoder (Encoder):         6,976 개
2026-02-27 00:27:42,362 - INFO -     - conv_front (CNN Backbone):        6,944 개
2026-02-27 00:27:42,362 - INFO -     - 1x1_conv (Channel Proj):          0 개
2026-02-27 00:27:42,362 - INFO -     - norm (LayerNorm):                 32 개
2026-02-27 00:27:42,362 - INFO -   - Decoder (Cross-Attention-based):    40,704 개
2026-02-27 00:27:42,362 - INFO -     - Embedding Layer (feat_to_emb):   544 개
2026-02-27 00:27:42,368 - INFO -     - Init Key Proj (W_K_init):         1,056 개
2026-02-27 00:27:42,368 - INFO -     - Init Value Proj (W_V_init):       1,056 개
2026-02-27 00:27:42,368 - INFO -     - Learnable Queries:                224 개
2026-02-27 00:27:42,368 - INFO -     - Decoder Layers:                   37,824 개
2026-02-27 00:27:42,368 - INFO -   - Classifier (Projection MLP):        7,714 개
2026-02-27 00:27:42,368 - INFO - Pruning 이후 finetuning_pruned 설정으로 미세 조정을 수행합니다.
2026-02-27 00:27:42,368 - INFO - 옵티마이저: AdamW (lr=0.001, weight_decay=0.0001)
2026-02-27 00:27:42,369 - INFO - 스케줄러: CosineAnnealingLR (T_max=80, eta_min=0.0001)
2026-02-27 00:27:42,369 - INFO - ==================================================
2026-02-27 00:27:42,369 - INFO - train 모드를 시작합니다.
2026-02-27 00:27:42,369 - INFO - 손실 함수: CrossEntropyLoss (label_smoothing: 0.1)
2026-02-27 00:27:42,369 - INFO - --------------------------------------------------
2026-02-27 00:27:42,369 - INFO - [LR]    [1/80] | Learning Rate: 0.001000
2026-02-27 00:27:47,227 - INFO - [Train] [1/80] | Loss: 0.5261 | Train Acc: 77.38%
2026-02-27 00:27:48,737 - INFO - [Valid] [1/80] | Loss: 0.5489 | Val Acc: 74.04%
2026-02-27 00:27:48,741 - INFO - [Metrics for 'abnormal'] | Precision: 0.6806 | Recall: 0.8280 | F1: 0.7471
2026-02-27 00:27:48,742 - INFO - [Metrics for 'normal'] | Precision: 0.8176 | Recall: 0.6648 | F1: 0.7333
2026-02-27 00:27:48,751 - INFO - [Best Model Saved] (val loss: 0.5489) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:48,752 - INFO - --------------------------------------------------
2026-02-27 00:27:48,752 - INFO - [LR]    [2/80] | Learning Rate: 0.001000
2026-02-27 00:27:53,009 - INFO - [Train] [2/80] | Loss: 0.4817 | Train Acc: 80.65%
2026-02-27 00:27:54,435 - INFO - [Valid] [2/80] | Loss: 0.5093 | Val Acc: 77.88%
2026-02-27 00:27:54,446 - INFO - [Metrics for 'abnormal'] | Precision: 0.7440 | Recall: 0.7962 | F1: 0.7692
2026-02-27 00:27:54,446 - INFO - [Metrics for 'normal'] | Precision: 0.8129 | Recall: 0.7637 | F1: 0.7875
2026-02-27 00:27:54,469 - INFO - [Best Model Saved] (val loss: 0.5093) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:27:54,470 - INFO - --------------------------------------------------
2026-02-27 00:27:54,470 - INFO - [LR]    [3/80] | Learning Rate: 0.000999
2026-02-27 00:27:59,016 - INFO - [Train] [3/80] | Loss: 0.4678 | Train Acc: 81.55%
2026-02-27 00:28:00,469 - INFO - [Valid] [3/80] | Loss: 0.5163 | Val Acc: 79.35%
2026-02-27 00:28:00,474 - INFO - [Metrics for 'abnormal'] | Precision: 0.8222 | Recall: 0.7070 | F1: 0.7603
2026-02-27 00:28:00,477 - INFO - [Metrics for 'normal'] | Precision: 0.7745 | Recall: 0.8681 | F1: 0.8187
2026-02-27 00:28:00,478 - INFO - --------------------------------------------------
2026-02-27 00:28:00,478 - INFO - [LR]    [4/80] | Learning Rate: 0.000997
2026-02-27 00:28:05,058 - INFO - [Train] [4/80] | Loss: 0.4598 | Train Acc: 82.96%
2026-02-27 00:28:06,636 - INFO - [Valid] [4/80] | Loss: 0.4780 | Val Acc: 81.12%
2026-02-27 00:28:06,644 - INFO - [Metrics for 'abnormal'] | Precision: 0.7925 | Recall: 0.8025 | F1: 0.7975
2026-02-27 00:28:06,647 - INFO - [Metrics for 'normal'] | Precision: 0.8278 | Recall: 0.8187 | F1: 0.8232
2026-02-27 00:28:06,666 - INFO - [Best Model Saved] (val loss: 0.4780) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:28:06,666 - INFO - --------------------------------------------------
2026-02-27 00:28:06,666 - INFO - [LR]    [5/80] | Learning Rate: 0.000994
2026-02-27 00:28:11,301 - INFO - [Train] [5/80] | Loss: 0.4729 | Train Acc: 81.25%
2026-02-27 00:28:12,609 - INFO - [Valid] [5/80] | Loss: 0.4983 | Val Acc: 79.94%
2026-02-27 00:28:12,622 - INFO - [Metrics for 'abnormal'] | Precision: 0.7834 | Recall: 0.7834 | F1: 0.7834
2026-02-27 00:28:12,623 - INFO - [Metrics for 'normal'] | Precision: 0.8132 | Recall: 0.8132 | F1: 0.8132
2026-02-27 00:28:12,623 - INFO - --------------------------------------------------
2026-02-27 00:28:12,626 - INFO - [LR]    [6/80] | Learning Rate: 0.000991
2026-02-27 00:28:17,077 - INFO - [Train] [6/80] | Loss: 0.4581 | Train Acc: 83.56%
2026-02-27 00:28:18,681 - INFO - [Valid] [6/80] | Loss: 0.5061 | Val Acc: 79.35%
2026-02-27 00:28:18,689 - INFO - [Metrics for 'abnormal'] | Precision: 0.8085 | Recall: 0.7261 | F1: 0.7651
2026-02-27 00:28:18,693 - INFO - [Metrics for 'normal'] | Precision: 0.7828 | Recall: 0.8516 | F1: 0.8158
2026-02-27 00:28:18,694 - INFO - --------------------------------------------------
2026-02-27 00:28:18,694 - INFO - [LR]    [7/80] | Learning Rate: 0.000988
2026-02-27 00:28:23,413 - INFO - [Train] [7/80] | Loss: 0.4586 | Train Acc: 83.85%
2026-02-27 00:28:24,887 - INFO - [Valid] [7/80] | Loss: 0.5883 | Val Acc: 78.17%
2026-02-27 00:28:24,896 - INFO - [Metrics for 'abnormal'] | Precision: 0.7196 | Recall: 0.8662 | F1: 0.7861
2026-02-27 00:28:24,900 - INFO - [Metrics for 'normal'] | Precision: 0.8600 | Recall: 0.7088 | F1: 0.7771
2026-02-27 00:28:24,901 - INFO - --------------------------------------------------
2026-02-27 00:28:24,901 - INFO - [LR]    [8/80] | Learning Rate: 0.000983
2026-02-27 00:28:29,449 - INFO - [Train] [8/80] | Loss: 0.4430 | Train Acc: 84.08%
2026-02-27 00:28:30,748 - INFO - [Valid] [8/80] | Loss: 0.5496 | Val Acc: 78.76%
2026-02-27 00:28:30,751 - INFO - [Metrics for 'abnormal'] | Precision: 0.7429 | Recall: 0.8280 | F1: 0.7831
2026-02-27 00:28:30,752 - INFO - [Metrics for 'normal'] | Precision: 0.8354 | Recall: 0.7527 | F1: 0.7919
2026-02-27 00:28:30,752 - INFO - --------------------------------------------------
2026-02-27 00:28:30,752 - INFO - [LR]    [9/80] | Learning Rate: 0.000978
2026-02-27 00:28:35,523 - INFO - [Train] [9/80] | Loss: 0.4383 | Train Acc: 84.15%
2026-02-27 00:28:36,676 - INFO - [Valid] [9/80] | Loss: 0.5391 | Val Acc: 77.58%
2026-02-27 00:28:36,683 - INFO - [Metrics for 'abnormal'] | Precision: 0.8932 | Recall: 0.5860 | F1: 0.7077
2026-02-27 00:28:36,687 - INFO - [Metrics for 'normal'] | Precision: 0.7246 | Recall: 0.9396 | F1: 0.8182
2026-02-27 00:28:36,687 - INFO - --------------------------------------------------
2026-02-27 00:28:36,687 - INFO - [LR]    [10/80] | Learning Rate: 0.000972
2026-02-27 00:28:41,675 - INFO - [Train] [10/80] | Loss: 0.4420 | Train Acc: 84.52%
2026-02-27 00:28:43,052 - INFO - [Valid] [10/80] | Loss: 0.4970 | Val Acc: 81.12%
2026-02-27 00:28:43,056 - INFO - [Metrics for 'abnormal'] | Precision: 0.7627 | Recall: 0.8599 | F1: 0.8084
2026-02-27 00:28:43,057 - INFO - [Metrics for 'normal'] | Precision: 0.8642 | Recall: 0.7692 | F1: 0.8140
2026-02-27 00:28:43,057 - INFO - --------------------------------------------------
2026-02-27 00:28:43,057 - INFO - [LR]    [11/80] | Learning Rate: 0.000966
2026-02-27 00:28:47,782 - INFO - [Train] [11/80] | Loss: 0.4397 | Train Acc: 84.00%
2026-02-27 00:28:48,923 - INFO - [Valid] [11/80] | Loss: 0.4614 | Val Acc: 82.89%
2026-02-27 00:28:48,926 - INFO - [Metrics for 'abnormal'] | Precision: 0.8278 | Recall: 0.7962 | F1: 0.8117
2026-02-27 00:28:48,926 - INFO - [Metrics for 'normal'] | Precision: 0.8298 | Recall: 0.8571 | F1: 0.8432
2026-02-27 00:28:48,931 - INFO - [Best Model Saved] (val loss: 0.4614) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:28:48,931 - INFO - --------------------------------------------------
2026-02-27 00:28:48,931 - INFO - [LR]    [12/80] | Learning Rate: 0.000959
2026-02-27 00:28:53,450 - INFO - [Train] [12/80] | Loss: 0.4435 | Train Acc: 84.60%
2026-02-27 00:28:54,643 - INFO - [Valid] [12/80] | Loss: 0.4840 | Val Acc: 80.53%
2026-02-27 00:28:54,649 - INFO - [Metrics for 'abnormal'] | Precision: 0.8699 | Recall: 0.6815 | F1: 0.7643
2026-02-27 00:28:54,649 - INFO - [Metrics for 'normal'] | Precision: 0.7685 | Recall: 0.9121 | F1: 0.8342
2026-02-27 00:28:54,649 - INFO - --------------------------------------------------
2026-02-27 00:28:54,649 - INFO - [LR]    [13/80] | Learning Rate: 0.000951
2026-02-27 00:28:59,323 - INFO - [Train] [13/80] | Loss: 0.4328 | Train Acc: 84.52%
2026-02-27 00:29:00,587 - INFO - [Valid] [13/80] | Loss: 0.5190 | Val Acc: 79.35%
2026-02-27 00:29:00,591 - INFO - [Metrics for 'abnormal'] | Precision: 0.7636 | Recall: 0.8025 | F1: 0.7826
2026-02-27 00:29:00,591 - INFO - [Metrics for 'normal'] | Precision: 0.8218 | Recall: 0.7857 | F1: 0.8034
2026-02-27 00:29:00,591 - INFO - --------------------------------------------------
2026-02-27 00:29:00,591 - INFO - [LR]    [14/80] | Learning Rate: 0.000943
2026-02-27 00:29:05,017 - INFO - [Train] [14/80] | Loss: 0.4277 | Train Acc: 84.60%
2026-02-27 00:29:06,013 - INFO - [Valid] [14/80] | Loss: 0.4919 | Val Acc: 81.42%
2026-02-27 00:29:06,017 - INFO - [Metrics for 'abnormal'] | Precision: 0.7831 | Recall: 0.8280 | F1: 0.8050
2026-02-27 00:29:06,017 - INFO - [Metrics for 'normal'] | Precision: 0.8439 | Recall: 0.8022 | F1: 0.8225
2026-02-27 00:29:06,017 - INFO - --------------------------------------------------
2026-02-27 00:29:06,017 - INFO - [LR]    [15/80] | Learning Rate: 0.000934
2026-02-27 00:29:10,797 - INFO - [Train] [15/80] | Loss: 0.4287 | Train Acc: 85.12%
2026-02-27 00:29:11,775 - INFO - [Valid] [15/80] | Loss: 0.4726 | Val Acc: 82.60%
2026-02-27 00:29:11,778 - INFO - [Metrics for 'abnormal'] | Precision: 0.8224 | Recall: 0.7962 | F1: 0.8091
2026-02-27 00:29:11,778 - INFO - [Metrics for 'normal'] | Precision: 0.8289 | Recall: 0.8516 | F1: 0.8401
2026-02-27 00:29:11,778 - INFO - --------------------------------------------------
2026-02-27 00:29:11,778 - INFO - [LR]    [16/80] | Learning Rate: 0.000924
2026-02-27 00:29:16,447 - INFO - [Train] [16/80] | Loss: 0.4275 | Train Acc: 85.86%
2026-02-27 00:29:17,588 - INFO - [Valid] [16/80] | Loss: 0.4715 | Val Acc: 81.71%
2026-02-27 00:29:17,590 - INFO - [Metrics for 'abnormal'] | Precision: 0.8276 | Recall: 0.7643 | F1: 0.7947
2026-02-27 00:29:17,590 - INFO - [Metrics for 'normal'] | Precision: 0.8093 | Recall: 0.8626 | F1: 0.8351
2026-02-27 00:29:17,590 - INFO - --------------------------------------------------
2026-02-27 00:29:17,590 - INFO - [LR]    [17/80] | Learning Rate: 0.000914
2026-02-27 00:29:21,776 - INFO - [Train] [17/80] | Loss: 0.4275 | Train Acc: 85.42%
2026-02-27 00:29:22,744 - INFO - [Valid] [17/80] | Loss: 0.5158 | Val Acc: 81.42%
2026-02-27 00:29:22,748 - INFO - [Metrics for 'abnormal'] | Precision: 0.7670 | Recall: 0.8599 | F1: 0.8108
2026-02-27 00:29:22,748 - INFO - [Metrics for 'normal'] | Precision: 0.8650 | Recall: 0.7747 | F1: 0.8174
2026-02-27 00:29:22,749 - INFO - --------------------------------------------------
2026-02-27 00:29:22,749 - INFO - [LR]    [18/80] | Learning Rate: 0.000903
2026-02-27 00:29:27,631 - INFO - [Train] [18/80] | Loss: 0.4152 | Train Acc: 85.94%
2026-02-27 00:29:28,789 - INFO - [Valid] [18/80] | Loss: 0.4802 | Val Acc: 79.94%
2026-02-27 00:29:28,793 - INFO - [Metrics for 'abnormal'] | Precision: 0.7834 | Recall: 0.7834 | F1: 0.7834
2026-02-27 00:29:28,793 - INFO - [Metrics for 'normal'] | Precision: 0.8132 | Recall: 0.8132 | F1: 0.8132
2026-02-27 00:29:28,794 - INFO - --------------------------------------------------
2026-02-27 00:29:28,794 - INFO - [LR]    [19/80] | Learning Rate: 0.000892
2026-02-27 00:29:33,080 - INFO - [Train] [19/80] | Loss: 0.4075 | Train Acc: 86.53%
2026-02-27 00:29:34,280 - INFO - [Valid] [19/80] | Loss: 0.4955 | Val Acc: 80.24%
2026-02-27 00:29:34,284 - INFO - [Metrics for 'abnormal'] | Precision: 0.7500 | Recall: 0.8599 | F1: 0.8012
2026-02-27 00:29:34,285 - INFO - [Metrics for 'normal'] | Precision: 0.8616 | Recall: 0.7527 | F1: 0.8035
2026-02-27 00:29:34,285 - INFO - --------------------------------------------------
2026-02-27 00:29:34,285 - INFO - [LR]    [20/80] | Learning Rate: 0.000880
2026-02-27 00:29:38,883 - INFO - [Train] [20/80] | Loss: 0.4172 | Train Acc: 86.31%
2026-02-27 00:29:40,019 - INFO - [Valid] [20/80] | Loss: 0.4638 | Val Acc: 82.01%
2026-02-27 00:29:40,024 - INFO - [Metrics for 'abnormal'] | Precision: 0.7759 | Recall: 0.8599 | F1: 0.8157
2026-02-27 00:29:40,024 - INFO - [Metrics for 'normal'] | Precision: 0.8667 | Recall: 0.7857 | F1: 0.8242
2026-02-27 00:29:40,024 - INFO - --------------------------------------------------
2026-02-27 00:29:40,024 - INFO - [LR]    [21/80] | Learning Rate: 0.000868
2026-02-27 00:29:45,180 - INFO - [Train] [21/80] | Loss: 0.3952 | Train Acc: 86.68%
2026-02-27 00:29:46,515 - INFO - [Valid] [21/80] | Loss: 0.4759 | Val Acc: 82.30%
2026-02-27 00:29:46,521 - INFO - [Metrics for 'abnormal'] | Precision: 0.7680 | Recall: 0.8854 | F1: 0.8225
2026-02-27 00:29:46,521 - INFO - [Metrics for 'normal'] | Precision: 0.8861 | Recall: 0.7692 | F1: 0.8235
2026-02-27 00:29:46,521 - INFO - --------------------------------------------------
2026-02-27 00:29:46,521 - INFO - [LR]    [22/80] | Learning Rate: 0.000855
2026-02-27 00:29:51,475 - INFO - [Train] [22/80] | Loss: 0.4066 | Train Acc: 86.24%
2026-02-27 00:29:52,641 - INFO - [Valid] [22/80] | Loss: 0.4705 | Val Acc: 82.60%
2026-02-27 00:29:52,653 - INFO - [Metrics for 'abnormal'] | Precision: 0.8101 | Recall: 0.8153 | F1: 0.8127
2026-02-27 00:29:52,653 - INFO - [Metrics for 'normal'] | Precision: 0.8398 | Recall: 0.8352 | F1: 0.8375
2026-02-27 00:29:52,653 - INFO - --------------------------------------------------
2026-02-27 00:29:52,654 - INFO - [LR]    [23/80] | Learning Rate: 0.000842
2026-02-27 00:29:57,668 - INFO - [Train] [23/80] | Loss: 0.3983 | Train Acc: 86.90%
2026-02-27 00:29:58,499 - INFO - [Valid] [23/80] | Loss: 0.4805 | Val Acc: 82.60%
2026-02-27 00:29:58,504 - INFO - [Metrics for 'abnormal'] | Precision: 0.8025 | Recall: 0.8280 | F1: 0.8150
2026-02-27 00:29:58,505 - INFO - [Metrics for 'normal'] | Precision: 0.8475 | Recall: 0.8242 | F1: 0.8357
2026-02-27 00:29:58,506 - INFO - --------------------------------------------------
2026-02-27 00:29:58,506 - INFO - [LR]    [24/80] | Learning Rate: 0.000829
2026-02-27 00:30:03,705 - INFO - [Train] [24/80] | Loss: 0.3856 | Train Acc: 87.20%
2026-02-27 00:30:04,870 - INFO - [Valid] [24/80] | Loss: 0.4706 | Val Acc: 82.89%
2026-02-27 00:30:04,877 - INFO - [Metrics for 'abnormal'] | Precision: 0.8779 | Recall: 0.7325 | F1: 0.7986
2026-02-27 00:30:04,877 - INFO - [Metrics for 'normal'] | Precision: 0.7981 | Recall: 0.9121 | F1: 0.8513
2026-02-27 00:30:04,877 - INFO - --------------------------------------------------
2026-02-27 00:30:04,877 - INFO - [LR]    [25/80] | Learning Rate: 0.000815
2026-02-27 00:30:09,554 - INFO - [Train] [25/80] | Loss: 0.3933 | Train Acc: 87.87%
2026-02-27 00:30:10,791 - INFO - [Valid] [25/80] | Loss: 0.4694 | Val Acc: 81.42%
2026-02-27 00:30:10,800 - INFO - [Metrics for 'abnormal'] | Precision: 0.8013 | Recall: 0.7962 | F1: 0.7987
2026-02-27 00:30:10,800 - INFO - [Metrics for 'normal'] | Precision: 0.8251 | Recall: 0.8297 | F1: 0.8274
2026-02-27 00:30:10,803 - INFO - --------------------------------------------------
2026-02-27 00:30:10,803 - INFO - [LR]    [26/80] | Learning Rate: 0.000800
2026-02-27 00:30:15,578 - INFO - [Train] [26/80] | Loss: 0.3834 | Train Acc: 88.32%
2026-02-27 00:30:17,294 - INFO - [Valid] [26/80] | Loss: 0.4571 | Val Acc: 83.19%
2026-02-27 00:30:17,298 - INFO - [Metrics for 'abnormal'] | Precision: 0.8125 | Recall: 0.8280 | F1: 0.8202
2026-02-27 00:30:17,298 - INFO - [Metrics for 'normal'] | Precision: 0.8492 | Recall: 0.8352 | F1: 0.8421
2026-02-27 00:30:17,307 - INFO - [Best Model Saved] (val loss: 0.4571) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:30:17,308 - INFO - --------------------------------------------------
2026-02-27 00:30:17,308 - INFO - [LR]    [27/80] | Learning Rate: 0.000785
2026-02-27 00:30:22,035 - INFO - [Train] [27/80] | Loss: 0.3834 | Train Acc: 88.91%
2026-02-27 00:30:23,335 - INFO - [Valid] [27/80] | Loss: 0.5035 | Val Acc: 80.53%
2026-02-27 00:30:23,346 - INFO - [Metrics for 'abnormal'] | Precision: 0.7542 | Recall: 0.8599 | F1: 0.8036
2026-02-27 00:30:23,349 - INFO - [Metrics for 'normal'] | Precision: 0.8625 | Recall: 0.7582 | F1: 0.8070
2026-02-27 00:30:23,349 - INFO - --------------------------------------------------
2026-02-27 00:30:23,349 - INFO - [LR]    [28/80] | Learning Rate: 0.000770
2026-02-27 00:30:28,071 - INFO - [Train] [28/80] | Loss: 0.3775 | Train Acc: 88.62%
2026-02-27 00:30:29,447 - INFO - [Valid] [28/80] | Loss: 0.4801 | Val Acc: 82.89%
2026-02-27 00:30:29,454 - INFO - [Metrics for 'abnormal'] | Precision: 0.8075 | Recall: 0.8280 | F1: 0.8176
2026-02-27 00:30:29,454 - INFO - [Metrics for 'normal'] | Precision: 0.8483 | Recall: 0.8297 | F1: 0.8389
2026-02-27 00:30:29,454 - INFO - --------------------------------------------------
2026-02-27 00:30:29,455 - INFO - [LR]    [29/80] | Learning Rate: 0.000754
2026-02-27 00:30:33,496 - INFO - [Train] [29/80] | Loss: 0.3787 | Train Acc: 88.02%
2026-02-27 00:30:34,913 - INFO - [Valid] [29/80] | Loss: 0.4913 | Val Acc: 80.24%
2026-02-27 00:30:34,917 - INFO - [Metrics for 'abnormal'] | Precision: 0.8082 | Recall: 0.7516 | F1: 0.7789
2026-02-27 00:30:34,917 - INFO - [Metrics for 'normal'] | Precision: 0.7979 | Recall: 0.8462 | F1: 0.8213
2026-02-27 00:30:34,917 - INFO - --------------------------------------------------
2026-02-27 00:30:34,917 - INFO - [LR]    [30/80] | Learning Rate: 0.000738
2026-02-27 00:30:38,932 - INFO - [Train] [30/80] | Loss: 0.3690 | Train Acc: 88.69%
2026-02-27 00:30:40,347 - INFO - [Valid] [30/80] | Loss: 0.4693 | Val Acc: 82.30%
2026-02-27 00:30:40,353 - INFO - [Metrics for 'abnormal'] | Precision: 0.8089 | Recall: 0.8089 | F1: 0.8089
2026-02-27 00:30:40,353 - INFO - [Metrics for 'normal'] | Precision: 0.8352 | Recall: 0.8352 | F1: 0.8352
2026-02-27 00:30:40,353 - INFO - --------------------------------------------------
2026-02-27 00:30:40,353 - INFO - [LR]    [31/80] | Learning Rate: 0.000722
2026-02-27 00:30:44,701 - INFO - [Train] [31/80] | Loss: 0.3762 | Train Acc: 88.47%
2026-02-27 00:30:45,958 - INFO - [Valid] [31/80] | Loss: 0.5371 | Val Acc: 78.17%
2026-02-27 00:30:45,971 - INFO - [Metrics for 'abnormal'] | Precision: 0.7943 | Recall: 0.7134 | F1: 0.7517
2026-02-27 00:30:45,971 - INFO - [Metrics for 'normal'] | Precision: 0.7727 | Recall: 0.8407 | F1: 0.8053
2026-02-27 00:30:45,972 - INFO - --------------------------------------------------
2026-02-27 00:30:45,972 - INFO - [LR]    [32/80] | Learning Rate: 0.000706
2026-02-27 00:30:50,348 - INFO - [Train] [32/80] | Loss: 0.3825 | Train Acc: 87.87%
2026-02-27 00:30:51,370 - INFO - [Valid] [32/80] | Loss: 0.4808 | Val Acc: 82.30%
2026-02-27 00:30:51,375 - INFO - [Metrics for 'abnormal'] | Precision: 0.7622 | Recall: 0.8981 | F1: 0.8246
2026-02-27 00:30:51,375 - INFO - [Metrics for 'normal'] | Precision: 0.8961 | Recall: 0.7582 | F1: 0.8214
2026-02-27 00:30:51,375 - INFO - --------------------------------------------------
2026-02-27 00:30:51,375 - INFO - [LR]    [33/80] | Learning Rate: 0.000689
2026-02-27 00:30:55,983 - INFO - [Train] [33/80] | Loss: 0.3642 | Train Acc: 89.14%
2026-02-27 00:30:56,970 - INFO - [Valid] [33/80] | Loss: 0.4968 | Val Acc: 81.71%
2026-02-27 00:30:56,987 - INFO - [Metrics for 'abnormal'] | Precision: 0.7568 | Recall: 0.8917 | F1: 0.8187
2026-02-27 00:30:56,987 - INFO - [Metrics for 'normal'] | Precision: 0.8896 | Recall: 0.7527 | F1: 0.8155
2026-02-27 00:30:56,991 - INFO - --------------------------------------------------
2026-02-27 00:30:56,991 - INFO - [LR]    [34/80] | Learning Rate: 0.000672
2026-02-27 00:31:02,007 - INFO - [Train] [34/80] | Loss: 0.3711 | Train Acc: 87.72%
2026-02-27 00:31:03,469 - INFO - [Valid] [34/80] | Loss: 0.4495 | Val Acc: 83.48%
2026-02-27 00:31:03,482 - INFO - [Metrics for 'abnormal'] | Precision: 0.8217 | Recall: 0.8217 | F1: 0.8217
2026-02-27 00:31:03,482 - INFO - [Metrics for 'normal'] | Precision: 0.8462 | Recall: 0.8462 | F1: 0.8462
2026-02-27 00:31:03,497 - INFO - [Best Model Saved] (val loss: 0.4495) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:31:03,499 - INFO - --------------------------------------------------
2026-02-27 00:31:03,501 - INFO - [LR]    [35/80] | Learning Rate: 0.000655
2026-02-27 00:31:08,188 - INFO - [Train] [35/80] | Loss: 0.3603 | Train Acc: 88.99%
2026-02-27 00:31:09,560 - INFO - [Valid] [35/80] | Loss: 0.4547 | Val Acc: 82.89%
2026-02-27 00:31:09,569 - INFO - [Metrics for 'abnormal'] | Precision: 0.8278 | Recall: 0.7962 | F1: 0.8117
2026-02-27 00:31:09,569 - INFO - [Metrics for 'normal'] | Precision: 0.8298 | Recall: 0.8571 | F1: 0.8432
2026-02-27 00:31:09,572 - INFO - --------------------------------------------------
2026-02-27 00:31:09,572 - INFO - [LR]    [36/80] | Learning Rate: 0.000638
2026-02-27 00:31:14,495 - INFO - [Train] [36/80] | Loss: 0.3612 | Train Acc: 88.91%
2026-02-27 00:31:15,693 - INFO - [Valid] [36/80] | Loss: 0.4858 | Val Acc: 82.30%
2026-02-27 00:31:15,700 - INFO - [Metrics for 'abnormal'] | Precision: 0.7566 | Recall: 0.9108 | F1: 0.8266
2026-02-27 00:31:15,700 - INFO - [Metrics for 'normal'] | Precision: 0.9067 | Recall: 0.7473 | F1: 0.8193
2026-02-27 00:31:15,700 - INFO - --------------------------------------------------
2026-02-27 00:31:15,700 - INFO - [LR]    [37/80] | Learning Rate: 0.000620
2026-02-27 00:31:20,622 - INFO - [Train] [37/80] | Loss: 0.3614 | Train Acc: 90.03%
2026-02-27 00:31:21,842 - INFO - [Valid] [37/80] | Loss: 0.4579 | Val Acc: 82.30%
2026-02-27 00:31:21,855 - INFO - [Metrics for 'abnormal'] | Precision: 0.7680 | Recall: 0.8854 | F1: 0.8225
2026-02-27 00:31:21,855 - INFO - [Metrics for 'normal'] | Precision: 0.8861 | Recall: 0.7692 | F1: 0.8235
2026-02-27 00:31:21,855 - INFO - --------------------------------------------------
2026-02-27 00:31:21,855 - INFO - [LR]    [38/80] | Learning Rate: 0.000603
2026-02-27 00:31:26,208 - INFO - [Train] [38/80] | Loss: 0.3624 | Train Acc: 89.73%
2026-02-27 00:31:27,568 - INFO - [Valid] [38/80] | Loss: 0.4524 | Val Acc: 84.37%
2026-02-27 00:31:27,577 - INFO - [Metrics for 'abnormal'] | Precision: 0.8210 | Recall: 0.8471 | F1: 0.8339
2026-02-27 00:31:27,577 - INFO - [Metrics for 'normal'] | Precision: 0.8644 | Recall: 0.8407 | F1: 0.8524
2026-02-27 00:31:27,580 - INFO - --------------------------------------------------
2026-02-27 00:31:27,580 - INFO - [LR]    [39/80] | Learning Rate: 0.000585
2026-02-27 00:31:32,090 - INFO - [Train] [39/80] | Loss: 0.3622 | Train Acc: 89.66%
2026-02-27 00:31:33,602 - INFO - [Valid] [39/80] | Loss: 0.4891 | Val Acc: 83.78%
2026-02-27 00:31:33,611 - INFO - [Metrics for 'abnormal'] | Precision: 0.8400 | Recall: 0.8025 | F1: 0.8208
2026-02-27 00:31:33,614 - INFO - [Metrics for 'normal'] | Precision: 0.8360 | Recall: 0.8681 | F1: 0.8518
2026-02-27 00:31:33,614 - INFO - --------------------------------------------------
2026-02-27 00:31:33,614 - INFO - [LR]    [40/80] | Learning Rate: 0.000568
2026-02-27 00:31:38,211 - INFO - [Train] [40/80] | Loss: 0.3462 | Train Acc: 89.06%
2026-02-27 00:31:39,512 - INFO - [Valid] [40/80] | Loss: 0.4779 | Val Acc: 82.60%
2026-02-27 00:31:39,516 - INFO - [Metrics for 'abnormal'] | Precision: 0.7816 | Recall: 0.8662 | F1: 0.8218
2026-02-27 00:31:39,517 - INFO - [Metrics for 'normal'] | Precision: 0.8727 | Recall: 0.7912 | F1: 0.8300
2026-02-27 00:31:39,517 - INFO - --------------------------------------------------
2026-02-27 00:31:39,517 - INFO - [LR]    [41/80] | Learning Rate: 0.000550
2026-02-27 00:31:44,657 - INFO - [Train] [41/80] | Loss: 0.3505 | Train Acc: 90.25%
2026-02-27 00:31:45,938 - INFO - [Valid] [41/80] | Loss: 0.4543 | Val Acc: 83.78%
2026-02-27 00:31:45,944 - INFO - [Metrics for 'abnormal'] | Precision: 0.8355 | Recall: 0.8089 | F1: 0.8220
2026-02-27 00:31:45,944 - INFO - [Metrics for 'normal'] | Precision: 0.8396 | Recall: 0.8626 | F1: 0.8509
2026-02-27 00:31:45,944 - INFO - --------------------------------------------------
2026-02-27 00:31:45,944 - INFO - [LR]    [42/80] | Learning Rate: 0.000532
2026-02-27 00:31:50,158 - INFO - [Train] [42/80] | Loss: 0.3512 | Train Acc: 90.48%
2026-02-27 00:31:51,432 - INFO - [Valid] [42/80] | Loss: 0.4613 | Val Acc: 83.48%
2026-02-27 00:31:51,448 - INFO - [Metrics for 'abnormal'] | Precision: 0.7953 | Recall: 0.8662 | F1: 0.8293
2026-02-27 00:31:51,451 - INFO - [Metrics for 'normal'] | Precision: 0.8750 | Recall: 0.8077 | F1: 0.8400
2026-02-27 00:31:51,451 - INFO - --------------------------------------------------
2026-02-27 00:31:51,453 - INFO - [LR]    [43/80] | Learning Rate: 0.000515
2026-02-27 00:31:56,249 - INFO - [Train] [43/80] | Loss: 0.3545 | Train Acc: 89.29%
2026-02-27 00:31:57,620 - INFO - [Valid] [43/80] | Loss: 0.4599 | Val Acc: 84.66%
2026-02-27 00:31:57,624 - INFO - [Metrics for 'abnormal'] | Precision: 0.8431 | Recall: 0.8217 | F1: 0.8323
2026-02-27 00:31:57,624 - INFO - [Metrics for 'normal'] | Precision: 0.8495 | Recall: 0.8681 | F1: 0.8587
2026-02-27 00:31:57,625 - INFO - --------------------------------------------------
2026-02-27 00:31:57,625 - INFO - [LR]    [44/80] | Learning Rate: 0.000497
2026-02-27 00:32:01,895 - INFO - [Train] [44/80] | Loss: 0.3426 | Train Acc: 90.33%
2026-02-27 00:32:03,230 - INFO - [Valid] [44/80] | Loss: 0.4788 | Val Acc: 82.30%
2026-02-27 00:32:03,237 - INFO - [Metrics for 'abnormal'] | Precision: 0.8299 | Recall: 0.7771 | F1: 0.8026
2026-02-27 00:32:03,237 - INFO - [Metrics for 'normal'] | Precision: 0.8177 | Recall: 0.8626 | F1: 0.8396
2026-02-27 00:32:03,237 - INFO - --------------------------------------------------
2026-02-27 00:32:03,237 - INFO - [LR]    [45/80] | Learning Rate: 0.000480
2026-02-27 00:32:07,736 - INFO - [Train] [45/80] | Loss: 0.3379 | Train Acc: 90.55%
2026-02-27 00:32:09,187 - INFO - [Valid] [45/80] | Loss: 0.4881 | Val Acc: 81.71%
2026-02-27 00:32:09,191 - INFO - [Metrics for 'abnormal'] | Precision: 0.7914 | Recall: 0.8217 | F1: 0.8063
2026-02-27 00:32:09,191 - INFO - [Metrics for 'normal'] | Precision: 0.8409 | Recall: 0.8132 | F1: 0.8268
2026-02-27 00:32:09,191 - INFO - --------------------------------------------------
2026-02-27 00:32:09,191 - INFO - [LR]    [46/80] | Learning Rate: 0.000462
2026-02-27 00:32:13,746 - INFO - [Train] [46/80] | Loss: 0.3464 | Train Acc: 90.10%
2026-02-27 00:32:14,983 - INFO - [Valid] [46/80] | Loss: 0.4882 | Val Acc: 82.60%
2026-02-27 00:32:14,990 - INFO - [Metrics for 'abnormal'] | Precision: 0.7917 | Recall: 0.8471 | F1: 0.8185
2026-02-27 00:32:14,991 - INFO - [Metrics for 'normal'] | Precision: 0.8596 | Recall: 0.8077 | F1: 0.8329
2026-02-27 00:32:14,991 - INFO - --------------------------------------------------
2026-02-27 00:32:14,991 - INFO - [LR]    [47/80] | Learning Rate: 0.000445
2026-02-27 00:32:19,452 - INFO - [Train] [47/80] | Loss: 0.3464 | Train Acc: 91.07%
2026-02-27 00:32:20,775 - INFO - [Valid] [47/80] | Loss: 0.4749 | Val Acc: 84.07%
2026-02-27 00:32:20,780 - INFO - [Metrics for 'abnormal'] | Precision: 0.8012 | Recall: 0.8726 | F1: 0.8354
2026-02-27 00:32:20,780 - INFO - [Metrics for 'normal'] | Precision: 0.8810 | Recall: 0.8132 | F1: 0.8457
2026-02-27 00:32:20,780 - INFO - --------------------------------------------------
2026-02-27 00:32:20,781 - INFO - [LR]    [48/80] | Learning Rate: 0.000428
2026-02-27 00:32:25,343 - INFO - [Train] [48/80] | Loss: 0.3335 | Train Acc: 90.40%
2026-02-27 00:32:26,367 - INFO - [Valid] [48/80] | Loss: 0.4761 | Val Acc: 82.01%
2026-02-27 00:32:26,371 - INFO - [Metrics for 'abnormal'] | Precision: 0.7609 | Recall: 0.8917 | F1: 0.8211
2026-02-27 00:32:26,371 - INFO - [Metrics for 'normal'] | Precision: 0.8903 | Recall: 0.7582 | F1: 0.8190
2026-02-27 00:32:26,372 - INFO - --------------------------------------------------
2026-02-27 00:32:26,372 - INFO - [LR]    [49/80] | Learning Rate: 0.000411
2026-02-27 00:32:30,621 - INFO - [Train] [49/80] | Loss: 0.3441 | Train Acc: 90.25%
2026-02-27 00:32:32,156 - INFO - [Valid] [49/80] | Loss: 0.4598 | Val Acc: 83.48%
2026-02-27 00:32:32,163 - INFO - [Metrics for 'abnormal'] | Precision: 0.7886 | Recall: 0.8790 | F1: 0.8313
2026-02-27 00:32:32,163 - INFO - [Metrics for 'normal'] | Precision: 0.8841 | Recall: 0.7967 | F1: 0.8382
2026-02-27 00:32:32,163 - INFO - --------------------------------------------------
2026-02-27 00:32:32,164 - INFO - [LR]    [50/80] | Learning Rate: 0.000394
2026-02-27 00:32:36,432 - INFO - [Train] [50/80] | Loss: 0.3320 | Train Acc: 91.44%
2026-02-27 00:32:37,629 - INFO - [Valid] [50/80] | Loss: 0.4734 | Val Acc: 82.89%
2026-02-27 00:32:37,633 - INFO - [Metrics for 'abnormal'] | Precision: 0.8235 | Recall: 0.8025 | F1: 0.8129
2026-02-27 00:32:37,633 - INFO - [Metrics for 'normal'] | Precision: 0.8333 | Recall: 0.8516 | F1: 0.8424
2026-02-27 00:32:37,633 - INFO - --------------------------------------------------
2026-02-27 00:32:37,633 - INFO - [LR]    [51/80] | Learning Rate: 0.000378
2026-02-27 00:32:41,785 - INFO - [Train] [51/80] | Loss: 0.3251 | Train Acc: 92.04%
2026-02-27 00:32:43,675 - INFO - [Valid] [51/80] | Loss: 0.4826 | Val Acc: 84.07%
2026-02-27 00:32:43,684 - INFO - [Metrics for 'abnormal'] | Precision: 0.8121 | Recall: 0.8535 | F1: 0.8323
2026-02-27 00:32:43,684 - INFO - [Metrics for 'normal'] | Precision: 0.8678 | Recall: 0.8297 | F1: 0.8483
2026-02-27 00:32:43,684 - INFO - --------------------------------------------------
2026-02-27 00:32:43,684 - INFO - [LR]    [52/80] | Learning Rate: 0.000362
2026-02-27 00:32:47,680 - INFO - [Train] [52/80] | Loss: 0.3365 | Train Acc: 91.29%
2026-02-27 00:32:49,282 - INFO - [Valid] [52/80] | Loss: 0.4579 | Val Acc: 82.60%
2026-02-27 00:32:49,287 - INFO - [Metrics for 'abnormal'] | Precision: 0.7816 | Recall: 0.8662 | F1: 0.8218
2026-02-27 00:32:49,287 - INFO - [Metrics for 'normal'] | Precision: 0.8727 | Recall: 0.7912 | F1: 0.8300
2026-02-27 00:32:49,287 - INFO - --------------------------------------------------
2026-02-27 00:32:49,287 - INFO - [LR]    [53/80] | Learning Rate: 0.000346
2026-02-27 00:32:52,920 - INFO - [Train] [53/80] | Loss: 0.3284 | Train Acc: 91.44%
2026-02-27 00:32:54,549 - INFO - [Valid] [53/80] | Loss: 0.4892 | Val Acc: 83.19%
2026-02-27 00:32:54,553 - INFO - [Metrics for 'abnormal'] | Precision: 0.7551 | Recall: 0.9427 | F1: 0.8385
2026-02-27 00:32:54,553 - INFO - [Metrics for 'normal'] | Precision: 0.9371 | Recall: 0.7363 | F1: 0.8246
2026-02-27 00:32:54,553 - INFO - --------------------------------------------------
2026-02-27 00:32:54,553 - INFO - [LR]    [54/80] | Learning Rate: 0.000330
2026-02-27 00:32:59,769 - INFO - [Train] [54/80] | Loss: 0.3251 | Train Acc: 91.74%
2026-02-27 00:33:00,927 - INFO - [Valid] [54/80] | Loss: 0.4597 | Val Acc: 84.37%
2026-02-27 00:33:00,930 - INFO - [Metrics for 'abnormal'] | Precision: 0.8333 | Recall: 0.8280 | F1: 0.8307
2026-02-27 00:33:00,930 - INFO - [Metrics for 'normal'] | Precision: 0.8525 | Recall: 0.8571 | F1: 0.8548
2026-02-27 00:33:00,930 - INFO - --------------------------------------------------
2026-02-27 00:33:00,930 - INFO - [LR]    [55/80] | Learning Rate: 0.000315
2026-02-27 00:33:05,203 - INFO - [Train] [55/80] | Loss: 0.3162 | Train Acc: 92.11%
2026-02-27 00:33:06,558 - INFO - [Valid] [55/80] | Loss: 0.4550 | Val Acc: 84.96%
2026-02-27 00:33:06,565 - INFO - [Metrics for 'abnormal'] | Precision: 0.8011 | Recall: 0.8981 | F1: 0.8468
2026-02-27 00:33:06,565 - INFO - [Metrics for 'normal'] | Precision: 0.9018 | Recall: 0.8077 | F1: 0.8522
2026-02-27 00:33:06,565 - INFO - --------------------------------------------------
2026-02-27 00:33:06,565 - INFO - [LR]    [56/80] | Learning Rate: 0.000300
2026-02-27 00:33:11,191 - INFO - [Train] [56/80] | Loss: 0.3181 | Train Acc: 92.86%
2026-02-27 00:33:12,799 - INFO - [Valid] [56/80] | Loss: 0.4723 | Val Acc: 83.19%
2026-02-27 00:33:12,818 - INFO - [Metrics for 'abnormal'] | Precision: 0.7841 | Recall: 0.8790 | F1: 0.8288
2026-02-27 00:33:12,819 - INFO - [Metrics for 'normal'] | Precision: 0.8834 | Recall: 0.7912 | F1: 0.8348
2026-02-27 00:33:12,819 - INFO - --------------------------------------------------
2026-02-27 00:33:12,819 - INFO - [LR]    [57/80] | Learning Rate: 0.000285
2026-02-27 00:33:17,230 - INFO - [Train] [57/80] | Loss: 0.3197 | Train Acc: 92.49%
2026-02-27 00:33:18,289 - INFO - [Valid] [57/80] | Loss: 0.4606 | Val Acc: 84.37%
2026-02-27 00:33:18,294 - INFO - [Metrics for 'abnormal'] | Precision: 0.8171 | Recall: 0.8535 | F1: 0.8349
2026-02-27 00:33:18,295 - INFO - [Metrics for 'normal'] | Precision: 0.8686 | Recall: 0.8352 | F1: 0.8515
2026-02-27 00:33:18,295 - INFO - --------------------------------------------------
2026-02-27 00:33:18,295 - INFO - [LR]    [58/80] | Learning Rate: 0.000271
2026-02-27 00:33:22,840 - INFO - [Train] [58/80] | Loss: 0.3161 | Train Acc: 92.78%
2026-02-27 00:33:24,018 - INFO - [Valid] [58/80] | Loss: 0.4579 | Val Acc: 83.78%
2026-02-27 00:33:24,023 - INFO - [Metrics for 'abnormal'] | Precision: 0.8110 | Recall: 0.8471 | F1: 0.8287
2026-02-27 00:33:24,023 - INFO - [Metrics for 'normal'] | Precision: 0.8629 | Recall: 0.8297 | F1: 0.8459
2026-02-27 00:33:24,024 - INFO - --------------------------------------------------
2026-02-27 00:33:24,024 - INFO - [LR]    [59/80] | Learning Rate: 0.000258
2026-02-27 00:33:28,551 - INFO - [Train] [59/80] | Loss: 0.3065 | Train Acc: 93.53%
2026-02-27 00:33:30,198 - INFO - [Valid] [59/80] | Loss: 0.4873 | Val Acc: 83.48%
2026-02-27 00:33:30,203 - INFO - [Metrics for 'abnormal'] | Precision: 0.7919 | Recall: 0.8726 | F1: 0.8303
2026-02-27 00:33:30,204 - INFO - [Metrics for 'normal'] | Precision: 0.8795 | Recall: 0.8022 | F1: 0.8391
2026-02-27 00:33:30,204 - INFO - --------------------------------------------------
2026-02-27 00:33:30,204 - INFO - [LR]    [60/80] | Learning Rate: 0.000245
2026-02-27 00:33:34,250 - INFO - [Train] [60/80] | Loss: 0.3174 | Train Acc: 92.71%
2026-02-27 00:33:35,349 - INFO - [Valid] [60/80] | Loss: 0.4812 | Val Acc: 84.07%
2026-02-27 00:33:35,356 - INFO - [Metrics for 'abnormal'] | Precision: 0.7943 | Recall: 0.8854 | F1: 0.8373
2026-02-27 00:33:35,356 - INFO - [Metrics for 'normal'] | Precision: 0.8902 | Recall: 0.8022 | F1: 0.8439
2026-02-27 00:33:35,356 - INFO - --------------------------------------------------
2026-02-27 00:33:35,356 - INFO - [LR]    [61/80] | Learning Rate: 0.000232
2026-02-27 00:33:40,232 - INFO - [Train] [61/80] | Loss: 0.3022 | Train Acc: 93.60%
2026-02-27 00:33:41,573 - INFO - [Valid] [61/80] | Loss: 0.4786 | Val Acc: 83.78%
2026-02-27 00:33:41,577 - INFO - [Metrics for 'abnormal'] | Precision: 0.8072 | Recall: 0.8535 | F1: 0.8297
2026-02-27 00:33:41,578 - INFO - [Metrics for 'normal'] | Precision: 0.8671 | Recall: 0.8242 | F1: 0.8451
2026-02-27 00:33:41,578 - INFO - --------------------------------------------------
2026-02-27 00:33:41,578 - INFO - [LR]    [62/80] | Learning Rate: 0.000220
2026-02-27 00:33:46,324 - INFO - [Train] [62/80] | Loss: 0.3079 | Train Acc: 93.15%
2026-02-27 00:33:47,409 - INFO - [Valid] [62/80] | Loss: 0.4778 | Val Acc: 83.19%
2026-02-27 00:33:47,417 - INFO - [Metrics for 'abnormal'] | Precision: 0.7941 | Recall: 0.8599 | F1: 0.8257
2026-02-27 00:33:47,417 - INFO - [Metrics for 'normal'] | Precision: 0.8698 | Recall: 0.8077 | F1: 0.8376
2026-02-27 00:33:47,418 - INFO - --------------------------------------------------
2026-02-27 00:33:47,418 - INFO - [LR]    [63/80] | Learning Rate: 0.000208
2026-02-27 00:33:52,015 - INFO - [Train] [63/80] | Loss: 0.3086 | Train Acc: 92.41%
2026-02-27 00:33:53,261 - INFO - [Valid] [63/80] | Loss: 0.4659 | Val Acc: 82.89%
2026-02-27 00:33:53,265 - INFO - [Metrics for 'abnormal'] | Precision: 0.7861 | Recall: 0.8662 | F1: 0.8242
2026-02-27 00:33:53,265 - INFO - [Metrics for 'normal'] | Precision: 0.8735 | Recall: 0.7967 | F1: 0.8333
2026-02-27 00:33:53,265 - INFO - --------------------------------------------------
2026-02-27 00:33:53,265 - INFO - [LR]    [64/80] | Learning Rate: 0.000197
2026-02-27 00:33:58,206 - INFO - [Train] [64/80] | Loss: 0.3060 | Train Acc: 93.68%
2026-02-27 00:33:59,374 - INFO - [Valid] [64/80] | Loss: 0.4632 | Val Acc: 84.96%
2026-02-27 00:33:59,399 - INFO - [Metrics for 'abnormal'] | Precision: 0.8081 | Recall: 0.8854 | F1: 0.8450
2026-02-27 00:33:59,402 - INFO - [Metrics for 'normal'] | Precision: 0.8922 | Recall: 0.8187 | F1: 0.8539
2026-02-27 00:33:59,402 - INFO - --------------------------------------------------
2026-02-27 00:33:59,402 - INFO - [LR]    [65/80] | Learning Rate: 0.000186
2026-02-27 00:34:04,230 - INFO - [Train] [65/80] | Loss: 0.3054 | Train Acc: 93.38%
2026-02-27 00:34:05,296 - INFO - [Valid] [65/80] | Loss: 0.4523 | Val Acc: 84.37%
2026-02-27 00:34:05,303 - INFO - [Metrics for 'abnormal'] | Precision: 0.8171 | Recall: 0.8535 | F1: 0.8349
2026-02-27 00:34:05,307 - INFO - [Metrics for 'normal'] | Precision: 0.8686 | Recall: 0.8352 | F1: 0.8515
2026-02-27 00:34:05,307 - INFO - --------------------------------------------------
2026-02-27 00:34:05,308 - INFO - [LR]    [66/80] | Learning Rate: 0.000176
2026-02-27 00:34:10,121 - INFO - [Train] [66/80] | Loss: 0.2995 | Train Acc: 93.82%
2026-02-27 00:34:11,014 - INFO - [Valid] [66/80] | Loss: 0.4562 | Val Acc: 85.84%
2026-02-27 00:34:11,018 - INFO - [Metrics for 'abnormal'] | Precision: 0.8471 | Recall: 0.8471 | F1: 0.8471
2026-02-27 00:34:11,018 - INFO - [Metrics for 'normal'] | Precision: 0.8681 | Recall: 0.8681 | F1: 0.8681
2026-02-27 00:34:11,019 - INFO - --------------------------------------------------
2026-02-27 00:34:11,019 - INFO - [LR]    [67/80] | Learning Rate: 0.000166
2026-02-27 00:34:15,806 - INFO - [Train] [67/80] | Loss: 0.3021 | Train Acc: 93.23%
2026-02-27 00:34:17,045 - INFO - [Valid] [67/80] | Loss: 0.4671 | Val Acc: 85.25%
2026-02-27 00:34:17,059 - INFO - [Metrics for 'abnormal'] | Precision: 0.8323 | Recall: 0.8535 | F1: 0.8428
2026-02-27 00:34:17,066 - INFO - [Metrics for 'normal'] | Precision: 0.8708 | Recall: 0.8516 | F1: 0.8611
2026-02-27 00:34:17,066 - INFO - --------------------------------------------------
2026-02-27 00:34:17,066 - INFO - [LR]    [68/80] | Learning Rate: 0.000157
2026-02-27 00:34:22,103 - INFO - [Train] [68/80] | Loss: 0.3006 | Train Acc: 92.63%
2026-02-27 00:34:23,409 - INFO - [Valid] [68/80] | Loss: 0.4465 | Val Acc: 84.96%
2026-02-27 00:34:23,414 - INFO - [Metrics for 'abnormal'] | Precision: 0.8232 | Recall: 0.8599 | F1: 0.8411
2026-02-27 00:34:23,415 - INFO - [Metrics for 'normal'] | Precision: 0.8743 | Recall: 0.8407 | F1: 0.8571
2026-02-27 00:34:23,424 - INFO - [Best Model Saved] (val loss: 0.4465) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:34:23,424 - INFO - --------------------------------------------------
2026-02-27 00:34:23,424 - INFO - [LR]    [69/80] | Learning Rate: 0.000149
2026-02-27 00:34:27,977 - INFO - [Train] [69/80] | Loss: 0.2982 | Train Acc: 93.38%
2026-02-27 00:34:29,254 - INFO - [Valid] [69/80] | Loss: 0.4655 | Val Acc: 85.25%
2026-02-27 00:34:29,259 - INFO - [Metrics for 'abnormal'] | Precision: 0.8166 | Recall: 0.8790 | F1: 0.8466
2026-02-27 00:34:29,259 - INFO - [Metrics for 'normal'] | Precision: 0.8882 | Recall: 0.8297 | F1: 0.8580
2026-02-27 00:34:29,259 - INFO - --------------------------------------------------
2026-02-27 00:34:29,259 - INFO - [LR]    [70/80] | Learning Rate: 0.000141
2026-02-27 00:34:33,752 - INFO - [Train] [70/80] | Loss: 0.2907 | Train Acc: 94.20%
2026-02-27 00:34:35,019 - INFO - [Valid] [70/80] | Loss: 0.4410 | Val Acc: 86.73%
2026-02-27 00:34:35,026 - INFO - [Metrics for 'abnormal'] | Precision: 0.8415 | Recall: 0.8790 | F1: 0.8598
2026-02-27 00:34:35,030 - INFO - [Metrics for 'normal'] | Precision: 0.8914 | Recall: 0.8571 | F1: 0.8739
2026-02-27 00:34:35,044 - INFO - [Best Model Saved] (val loss: 0.4410) -> 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 00:34:35,048 - INFO - --------------------------------------------------
2026-02-27 00:34:35,048 - INFO - [LR]    [71/80] | Learning Rate: 0.000134
2026-02-27 00:34:39,442 - INFO - [Train] [71/80] | Loss: 0.2962 | Train Acc: 94.12%
2026-02-27 00:34:40,871 - INFO - [Valid] [71/80] | Loss: 0.4914 | Val Acc: 85.25%
2026-02-27 00:34:40,879 - INFO - [Metrics for 'abnormal'] | Precision: 0.8323 | Recall: 0.8535 | F1: 0.8428
2026-02-27 00:34:40,883 - INFO - [Metrics for 'normal'] | Precision: 0.8708 | Recall: 0.8516 | F1: 0.8611
2026-02-27 00:34:40,883 - INFO - --------------------------------------------------
2026-02-27 00:34:40,883 - INFO - [LR]    [72/80] | Learning Rate: 0.000128
2026-02-27 00:34:45,536 - INFO - [Train] [72/80] | Loss: 0.2973 | Train Acc: 93.23%
2026-02-27 00:34:46,845 - INFO - [Valid] [72/80] | Loss: 0.4615 | Val Acc: 86.14%
2026-02-27 00:34:46,851 - INFO - [Metrics for 'abnormal'] | Precision: 0.8354 | Recall: 0.8726 | F1: 0.8536
2026-02-27 00:34:46,851 - INFO - [Metrics for 'normal'] | Precision: 0.8857 | Recall: 0.8516 | F1: 0.8683
2026-02-27 00:34:46,852 - INFO - --------------------------------------------------
2026-02-27 00:34:46,852 - INFO - [LR]    [73/80] | Learning Rate: 0.000122
2026-02-27 00:34:51,625 - INFO - [Train] [73/80] | Loss: 0.2876 | Train Acc: 94.87%
2026-02-27 00:34:53,129 - INFO - [Valid] [73/80] | Loss: 0.4743 | Val Acc: 84.66%
2026-02-27 00:34:53,139 - INFO - [Metrics for 'abnormal'] | Precision: 0.8035 | Recall: 0.8854 | F1: 0.8424
2026-02-27 00:34:53,141 - INFO - [Metrics for 'normal'] | Precision: 0.8916 | Recall: 0.8132 | F1: 0.8506
2026-02-27 00:34:53,141 - INFO - --------------------------------------------------
2026-02-27 00:34:53,141 - INFO - [LR]    [74/80] | Learning Rate: 0.000117
2026-02-27 00:34:57,537 - INFO - [Train] [74/80] | Loss: 0.3011 | Train Acc: 93.53%
2026-02-27 00:34:58,634 - INFO - [Valid] [74/80] | Loss: 0.4544 | Val Acc: 85.55%
2026-02-27 00:34:58,638 - INFO - [Metrics for 'abnormal'] | Precision: 0.8293 | Recall: 0.8662 | F1: 0.8474
2026-02-27 00:34:58,638 - INFO - [Metrics for 'normal'] | Precision: 0.8800 | Recall: 0.8462 | F1: 0.8627
2026-02-27 00:34:58,638 - INFO - --------------------------------------------------
2026-02-27 00:34:58,638 - INFO - [LR]    [75/80] | Learning Rate: 0.000112
2026-02-27 00:35:02,374 - INFO - [Train] [75/80] | Loss: 0.2972 | Train Acc: 93.60%
2026-02-27 00:35:03,437 - INFO - [Valid] [75/80] | Loss: 0.4725 | Val Acc: 84.96%
2026-02-27 00:35:03,441 - INFO - [Metrics for 'abnormal'] | Precision: 0.8313 | Recall: 0.8471 | F1: 0.8391
2026-02-27 00:35:03,441 - INFO - [Metrics for 'normal'] | Precision: 0.8659 | Recall: 0.8516 | F1: 0.8587
2026-02-27 00:35:03,441 - INFO - --------------------------------------------------
2026-02-27 00:35:03,441 - INFO - [LR]    [76/80] | Learning Rate: 0.000109
2026-02-27 00:35:06,500 - INFO - [Train] [76/80] | Loss: 0.3001 | Train Acc: 93.45%
2026-02-27 00:35:07,318 - INFO - [Valid] [76/80] | Loss: 0.4548 | Val Acc: 86.73%
2026-02-27 00:35:07,328 - INFO - [Metrics for 'abnormal'] | Precision: 0.8636 | Recall: 0.8471 | F1: 0.8553
2026-02-27 00:35:07,332 - INFO - [Metrics for 'normal'] | Precision: 0.8703 | Recall: 0.8846 | F1: 0.8774
2026-02-27 00:35:07,332 - INFO - --------------------------------------------------
2026-02-27 00:35:07,332 - INFO - [LR]    [77/80] | Learning Rate: 0.000106
2026-02-27 00:35:09,989 - INFO - [Train] [77/80] | Loss: 0.2809 | Train Acc: 95.31%
2026-02-27 00:35:10,773 - INFO - [Valid] [77/80] | Loss: 0.4667 | Val Acc: 85.84%
2026-02-27 00:35:10,776 - INFO - [Metrics for 'abnormal'] | Precision: 0.8150 | Recall: 0.8981 | F1: 0.8545
2026-02-27 00:35:10,776 - INFO - [Metrics for 'normal'] | Precision: 0.9036 | Recall: 0.8242 | F1: 0.8621
2026-02-27 00:35:10,777 - INFO - --------------------------------------------------
2026-02-27 00:35:10,777 - INFO - [LR]    [78/80] | Learning Rate: 0.000103
2026-02-27 00:35:13,067 - INFO - [Train] [78/80] | Loss: 0.2776 | Train Acc: 94.87%
2026-02-27 00:35:13,822 - INFO - [Valid] [78/80] | Loss: 0.4986 | Val Acc: 85.84%
2026-02-27 00:35:13,825 - INFO - [Metrics for 'abnormal'] | Precision: 0.8516 | Recall: 0.8408 | F1: 0.8462
2026-02-27 00:35:13,825 - INFO - [Metrics for 'normal'] | Precision: 0.8641 | Recall: 0.8736 | F1: 0.8689
2026-02-27 00:35:13,825 - INFO - --------------------------------------------------
2026-02-27 00:35:13,825 - INFO - [LR]    [79/80] | Learning Rate: 0.000101
2026-02-27 00:35:16,070 - INFO - [Train] [79/80] | Loss: 0.2970 | Train Acc: 94.05%
2026-02-27 00:35:16,839 - INFO - [Valid] [79/80] | Loss: 0.4552 | Val Acc: 84.96%
2026-02-27 00:35:16,843 - INFO - [Metrics for 'abnormal'] | Precision: 0.8118 | Recall: 0.8790 | F1: 0.8440
2026-02-27 00:35:16,843 - INFO - [Metrics for 'normal'] | Precision: 0.8876 | Recall: 0.8242 | F1: 0.8547
2026-02-27 00:35:16,843 - INFO - --------------------------------------------------
2026-02-27 00:35:16,843 - INFO - [LR]    [80/80] | Learning Rate: 0.000100
2026-02-27 00:35:19,101 - INFO - [Train] [80/80] | Loss: 0.2853 | Train Acc: 95.01%
2026-02-27 00:35:19,952 - INFO - [Valid] [80/80] | Loss: 0.4762 | Val Acc: 85.55%
2026-02-27 00:35:19,954 - INFO - [Metrics for 'abnormal'] | Precision: 0.8253 | Recall: 0.8726 | F1: 0.8483
2026-02-27 00:35:19,955 - INFO - [Metrics for 'normal'] | Precision: 0.8844 | Recall: 0.8407 | F1: 0.8620
2026-02-27 00:35:19,955 - INFO - 훈련 완료. 최고 성능 모델 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth'을(를) 불러와 테스트 세트로 최종 평가합니다.
2026-02-27 00:35:20,023 - INFO - ICAM Pruning 정책: full_model (encoder+decoder+classifier 대상, 마지막 분류층/attention qkv/embedding bridge/learnable queries 제외). ignored_layers=23
2026-02-27 00:35:20,024 - INFO - Wanda Pruning을 시작합니다.
2026-02-27 00:35:20,024 - INFO - 저장된 pruning_history가 있어 Wanda calibration을 건너뜁니다.
2026-02-27 00:35:20,024 - INFO - 분류 레이어 'Linear'을(를) Pruning 대상에서 제외합니다.
2026-02-27 00:35:20,083 - INFO - 저장된 pruning_history를 사용해 Pruning 구조를 재현했습니다.
2026-02-27 00:35:20,084 - INFO - torch-pruning 완료. 모델 구조가 희소도(0.5)에 맞춰 변경되었습니다.
2026-02-27 00:35:20,084 - INFO - ==================================================
2026-02-27 00:35:20,115 - INFO - ==================================================
2026-02-27 00:35:20,115 - INFO - Test 모드를 시작합니다.
2026-02-27 00:35:20,146 - INFO - 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/best_model.pth' 가중치 로드 완료.
2026-02-27 00:35:20,146 - INFO - FLOPs 및 MACs 측정을 시작합니다...
2026-02-27 00:35:20,151 - WARNING - FLOPs/MACs 측정 중 오류 발생: Only Tensors created explicitly by the user (graph leaves) support the deepcopy protocol at the moment.  If you were attempting to deepcopy a module, this may be because of a torch.nn.utils.weight_norm usage, see https://github.com/pytorch/pytorch/pull/103001
2026-02-27 00:35:21,208 - INFO - [Test] Loss: 0.3374 | Test Acc: 86.73%
2026-02-27 00:35:21,211 - INFO - [Metrics for 'abnormal'] | Precision: 0.8415 | Recall: 0.8790 | F1: 0.8598
2026-02-27 00:35:21,211 - INFO - [Metrics for 'normal'] | Precision: 0.8914 | Recall: 0.8571 | F1: 0.8739
2026-02-27 00:35:21,372 - INFO - ==================================================
2026-02-27 00:35:21,372 - INFO - 혼동 행렬 저장 완료. 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/confusion_matrix_20260227_002640.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/confusion_matrix_20260227_002640.pdf'
2026-02-27 00:35:21,372 - INFO - 어텐션 맵 시각화를 시작합니다 (339개 샘플, 저장 위치: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/attention_map_20260227_002640').
2026-02-27 01:02:55,333 - INFO - 어텐션 맵 339개 저장 완료.
2026-02-27 01:02:55,432 - INFO - Val Acc 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/val_acc.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/val_acc.pdf'
2026-02-27 01:02:55,544 - INFO - Train/Val Acc 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/train_val_acc.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/train_val_acc.pdf'
2026-02-27 01:02:55,638 - INFO - F1 (normal) 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/F1_normal.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/F1_normal.pdf'
2026-02-27 01:02:55,745 - INFO - Validation Loss 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/val_loss.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/val_loss.pdf'
2026-02-27 01:02:55,841 - INFO - Learning Rate 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/learning_rate.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/learning_rate.pdf'
2026-02-27 01:02:56,783 - INFO - 종합 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/compile.png' and 'log/Sewer_TAPNEW/main_20260227_002640_grid7_patch7_layer6_head4/graph_20260227_002640/compile.pdf'
