2026-02-26 22:30:35,882 - INFO - 로그 파일이 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/log_20260226_223035.log'에 저장됩니다.
2026-02-26 22:30:35,882 - INFO - 전역 랜덤 시드를 42로 고정합니다.
2026-02-26 22:30:35,884 - INFO - ==================================================
2026-02-26 22:30:35,884 - INFO - config.yaml:
2026-02-26 22:30:35,884 - INFO - 
run:
  global_seed: 42
  cuda: true
  mode: train
  pth_best_name: best_model.pth
  only_inference: false
  show_log: true
  dataset:
    name: Sewer_TAPNEW
    type: image_folder
    train_split_ratio: 0.8
    paths:
      train_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/train
      valid_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      test_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      train_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Train.csv
      valid_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      test_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      img_folder: /home/tai/workspace/ssd1/data/Sewer/Sewer-TAPNEW
  random_sampling_ratio:
    train: 1.0
    valid: 1.0
    test: 1.0
  num_workers: 16
model:
  img_size: 224
  num_patches_per_side: 7
  num_decoder_patches: 7
  num_decoder_layers: 6
  num_heads: 4
  cnn_feature_extractor:
    name: custom32
  encoder_dim: 32
  emb_dim: 32
  adaptive_initial_query: true
  decoder_ff_ratio: 2
  dropout: 0.1
  positional_encoding: true
  drop_path_ratio: 0.2
  visualize_attention: true
  num_plot_attention: 1500
training_main:
  epochs: 10
  batch_size: 16
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 10
    eta_min: 0.0001
  best_model_criterion: val_loss
training_baseline:
  model_name: mobilenet_v4_s
  epochs: 10
  batch_size: 16
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 10
    eta_min: 0.0001
  best_model_criterion: val_loss
finetuning_pruned:
  epochs: 80
  batch_size: 16
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 80
    eta_min: 0.0001
  best_model_criterion: val_loss
  use_wanda_pruning: true
  num_wanda_calib_samples: 1353
  pruning_sparsity: 0.7
  exclude_attention_qkv_pruning: true
  exclude_embedding_bridge_pruning: true
  exclude_learnable_queries_pruning: true

2026-02-26 22:30:35,884 - INFO - ==================================================
2026-02-26 22:30:35,908 - INFO - CUDA 사용 가능. GPU 사용을 시작합니다. (Device: NVIDIA GeForce RTX 5090)
2026-02-26 22:30:35,909 - INFO - 'Sewer_TAPNEW' 데이터 로드를 시작합니다 (Type: image_folder).
2026-02-26 22:30:35,909 - INFO - '/home/tai/workspace/ssd1/data/Sewer/Sewer-TAPNEW' 경로의 데이터를 훈련/테스트셋으로 분할합니다.
2026-02-26 22:30:35,912 - INFO - 총 1692개 데이터를 훈련용 1353개, 테스트용 339개로 분할합니다 (split_seed=42).
2026-02-26 22:30:35,912 - INFO - 데이터셋 클래스: ['abnormal', 'normal'] (총 2개)
2026-02-26 22:30:35,912 - INFO - 훈련 데이터: 1353개, 검증 데이터: 339개, 테스트 데이터: 339개
2026-02-26 22:30:35,912 - INFO - 이미지 크기: 224, 그리드 크기: 7x7 -> 인코더 패치 수: 49개
2026-02-26 22:30:36,015 - INFO - ==================================================
2026-02-26 22:30:36,015 - INFO - 모델 파라미터 수: 91,138 개
2026-02-26 22:30:36,015 - INFO -   - Encoder (Encoder):         22,656 개
2026-02-26 22:30:36,015 - INFO -     - conv_front (CNN Backbone):        22,592 개
2026-02-26 22:30:36,015 - INFO -     - 1x1_conv (Channel Proj):          0 개
2026-02-26 22:30:36,015 - INFO -     - norm (LayerNorm):                 64 개
2026-02-26 22:30:36,015 - INFO -   - Decoder (Cross-Attention-based):    53,504 개
2026-02-26 22:30:36,015 - INFO -     - Embedding Layer (feat_to_emb):   1,056 개
2026-02-26 22:30:36,015 - INFO -     - Init Key Proj (W_K_init):         1,056 개
2026-02-26 22:30:36,015 - INFO -     - Init Value Proj (W_V_init):       1,056 개
2026-02-26 22:30:36,015 - INFO -     - Learnable Queries:                224 개
2026-02-26 22:30:36,015 - INFO -     - Decoder Layers:                   50,112 개
2026-02-26 22:30:36,015 - INFO -   - Classifier (Projection MLP):        14,978 개
2026-02-26 22:30:36,015 - INFO - ================================================================================
2026-02-26 22:30:36,015 - INFO - 단계 1/2: training_main 기반 사전 훈련(Pre-training)을 시작합니다.
2026-02-26 22:30:36,015 - INFO - ================================================================================
2026-02-26 22:30:36,015 - INFO - 옵티마이저: AdamW (lr=0.001, weight_decay=0.0001)
2026-02-26 22:30:36,015 - INFO - 스케줄러: CosineAnnealingLR (T_max=10, eta_min=0.0001)
2026-02-26 22:30:36,015 - INFO - ==================================================
2026-02-26 22:30:36,015 - INFO - train 모드를 시작합니다.
2026-02-26 22:30:36,015 - INFO - 손실 함수: CrossEntropyLoss (label_smoothing: 0.1)
2026-02-26 22:30:36,015 - INFO - --------------------------------------------------
2026-02-26 22:30:36,015 - INFO - [LR]    [1/10] | Learning Rate: 0.001000
2026-02-26 22:30:40,920 - INFO - [Train] [1/10] | Loss: 0.5460 | Train Acc: 75.74%
2026-02-26 22:30:43,124 - INFO - [Valid] [1/10] | Loss: 0.5527 | Val Acc: 73.45%
2026-02-26 22:30:43,133 - INFO - [Metrics for 'abnormal'] | Precision: 0.6603 | Recall: 0.8790 | F1: 0.7541
2026-02-26 22:30:43,133 - INFO - [Metrics for 'normal'] | Precision: 0.8538 | Recall: 0.6099 | F1: 0.7115
2026-02-26 22:30:43,155 - INFO - [Best Model Saved] (val loss: 0.5527) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:30:43,156 - INFO - --------------------------------------------------
2026-02-26 22:30:43,156 - INFO - [LR]    [2/10] | Learning Rate: 0.000978
2026-02-26 22:30:46,685 - INFO - [Train] [2/10] | Loss: 0.5037 | Train Acc: 78.50%
2026-02-26 22:30:48,069 - INFO - [Valid] [2/10] | Loss: 0.5220 | Val Acc: 76.99%
2026-02-26 22:30:48,087 - INFO - [Metrics for 'abnormal'] | Precision: 0.7453 | Recall: 0.7643 | F1: 0.7547
2026-02-26 22:30:48,087 - INFO - [Metrics for 'normal'] | Precision: 0.7921 | Recall: 0.7747 | F1: 0.7833
2026-02-26 22:30:48,114 - INFO - [Best Model Saved] (val loss: 0.5220) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:30:48,115 - INFO - --------------------------------------------------
2026-02-26 22:30:48,115 - INFO - [LR]    [3/10] | Learning Rate: 0.000914
2026-02-26 22:30:52,347 - INFO - [Train] [3/10] | Loss: 0.5003 | Train Acc: 79.54%
2026-02-26 22:30:53,703 - INFO - [Valid] [3/10] | Loss: 0.5614 | Val Acc: 74.63%
2026-02-26 22:30:53,717 - INFO - [Metrics for 'abnormal'] | Precision: 0.6766 | Recall: 0.8662 | F1: 0.7598
2026-02-26 22:30:53,717 - INFO - [Metrics for 'normal'] | Precision: 0.8478 | Recall: 0.6429 | F1: 0.7312
2026-02-26 22:30:53,718 - INFO - --------------------------------------------------
2026-02-26 22:30:53,718 - INFO - [LR]    [4/10] | Learning Rate: 0.000815
2026-02-26 22:30:57,973 - INFO - [Train] [4/10] | Loss: 0.4847 | Train Acc: 81.18%
2026-02-26 22:30:59,565 - INFO - [Valid] [4/10] | Loss: 0.5138 | Val Acc: 78.76%
2026-02-26 22:30:59,587 - INFO - [Metrics for 'abnormal'] | Precision: 0.7576 | Recall: 0.7962 | F1: 0.7764
2026-02-26 22:30:59,590 - INFO - [Metrics for 'normal'] | Precision: 0.8161 | Recall: 0.7802 | F1: 0.7978
2026-02-26 22:30:59,615 - INFO - [Best Model Saved] (val loss: 0.5138) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:30:59,616 - INFO - --------------------------------------------------
2026-02-26 22:30:59,616 - INFO - [LR]    [5/10] | Learning Rate: 0.000689
2026-02-26 22:31:04,164 - INFO - [Train] [5/10] | Loss: 0.4578 | Train Acc: 83.41%
2026-02-26 22:31:05,588 - INFO - [Valid] [5/10] | Loss: 0.4978 | Val Acc: 81.71%
2026-02-26 22:31:05,597 - INFO - [Metrics for 'abnormal'] | Precision: 0.7987 | Recall: 0.8089 | F1: 0.8038
2026-02-26 22:31:05,601 - INFO - [Metrics for 'normal'] | Precision: 0.8333 | Recall: 0.8242 | F1: 0.8287
2026-02-26 22:31:05,617 - INFO - [Best Model Saved] (val loss: 0.4978) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:05,621 - INFO - --------------------------------------------------
2026-02-26 22:31:05,621 - INFO - [LR]    [6/10] | Learning Rate: 0.000550
2026-02-26 22:31:09,706 - INFO - [Train] [6/10] | Loss: 0.4617 | Train Acc: 82.81%
2026-02-26 22:31:10,905 - INFO - [Valid] [6/10] | Loss: 0.4784 | Val Acc: 82.60%
2026-02-26 22:31:10,909 - INFO - [Metrics for 'abnormal'] | Precision: 0.8356 | Recall: 0.7771 | F1: 0.8053
2026-02-26 22:31:10,910 - INFO - [Metrics for 'normal'] | Precision: 0.8187 | Recall: 0.8681 | F1: 0.8427
2026-02-26 22:31:10,918 - INFO - [Best Model Saved] (val loss: 0.4784) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:10,918 - INFO - --------------------------------------------------
2026-02-26 22:31:10,918 - INFO - [LR]    [7/10] | Learning Rate: 0.000411
2026-02-26 22:31:15,355 - INFO - [Train] [7/10] | Loss: 0.4516 | Train Acc: 83.11%
2026-02-26 22:31:16,732 - INFO - [Valid] [7/10] | Loss: 0.4634 | Val Acc: 83.78%
2026-02-26 22:31:16,736 - INFO - [Metrics for 'abnormal'] | Precision: 0.8228 | Recall: 0.8280 | F1: 0.8254
2026-02-26 22:31:16,737 - INFO - [Metrics for 'normal'] | Precision: 0.8508 | Recall: 0.8462 | F1: 0.8485
2026-02-26 22:31:16,745 - INFO - [Best Model Saved] (val loss: 0.4634) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:16,745 - INFO - --------------------------------------------------
2026-02-26 22:31:16,745 - INFO - [LR]    [8/10] | Learning Rate: 0.000285
2026-02-26 22:31:21,030 - INFO - [Train] [8/10] | Loss: 0.4396 | Train Acc: 83.93%
2026-02-26 22:31:22,365 - INFO - [Valid] [8/10] | Loss: 0.4734 | Val Acc: 81.12%
2026-02-26 22:31:22,377 - INFO - [Metrics for 'abnormal'] | Precision: 0.8163 | Recall: 0.7643 | F1: 0.7895
2026-02-26 22:31:22,377 - INFO - [Metrics for 'normal'] | Precision: 0.8073 | Recall: 0.8516 | F1: 0.8289
2026-02-26 22:31:22,377 - INFO - --------------------------------------------------
2026-02-26 22:31:22,377 - INFO - [LR]    [9/10] | Learning Rate: 0.000186
2026-02-26 22:31:26,493 - INFO - [Train] [9/10] | Loss: 0.4368 | Train Acc: 84.30%
2026-02-26 22:31:27,772 - INFO - [Valid] [9/10] | Loss: 0.4540 | Val Acc: 83.78%
2026-02-26 22:31:27,783 - INFO - [Metrics for 'abnormal'] | Precision: 0.8312 | Recall: 0.8153 | F1: 0.8232
2026-02-26 22:31:27,787 - INFO - [Metrics for 'normal'] | Precision: 0.8432 | Recall: 0.8571 | F1: 0.8501
2026-02-26 22:31:27,802 - INFO - [Best Model Saved] (val loss: 0.4540) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:27,806 - INFO - --------------------------------------------------
2026-02-26 22:31:27,806 - INFO - [LR]    [10/10] | Learning Rate: 0.000122
2026-02-26 22:31:32,755 - INFO - [Train] [10/10] | Loss: 0.4374 | Train Acc: 84.30%
2026-02-26 22:31:34,058 - INFO - [Valid] [10/10] | Loss: 0.4602 | Val Acc: 83.48%
2026-02-26 22:31:34,069 - INFO - [Metrics for 'abnormal'] | Precision: 0.8176 | Recall: 0.8280 | F1: 0.8228
2026-02-26 22:31:34,069 - INFO - [Metrics for 'normal'] | Precision: 0.8500 | Recall: 0.8407 | F1: 0.8453
2026-02-26 22:31:34,070 - INFO - ================================================================================
2026-02-26 22:31:34,071 - INFO - 단계 2/2: Pruning 및 finetuning_pruned 기반 미세 조정을 시작합니다.
2026-02-26 22:31:34,074 - INFO - ================================================================================
2026-02-26 22:31:34,131 - INFO - 사전 훈련된 모델 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'을(를) 불러왔습니다.
2026-02-26 22:31:34,135 - INFO - ICAM Pruning 정책: full_model (encoder+decoder+classifier 대상, 마지막 분류층/attention qkv/embedding bridge/learnable queries 제외). ignored_layers=23
2026-02-26 22:31:34,137 - INFO - Wanda Pruning을 시작합니다.
2026-02-26 22:31:34,137 - INFO - Wanda 중요도 계산을 위해 Calibration을 수행합니다.
2026-02-26 22:31:34,138 - INFO -   - Calibration Samples: 1353 (approx 85 batches)
2026-02-26 22:31:38,515 - INFO - 분류 레이어 'Linear'을(를) Pruning 대상에서 제외합니다.
2026-02-26 22:31:38,676 - INFO - torch-pruning 완료. 모델 구조가 희소도(0.7)에 맞춰 변경되었습니다.
2026-02-26 22:31:38,676 - INFO - ==================================================
2026-02-26 22:31:38,686 - INFO - Pruning 정보(희소도: 0.7000)를 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/pruning_info.yaml'에 저장했습니다.
2026-02-26 22:31:38,686 - INFO - ==================================================
2026-02-26 22:31:38,687 - INFO - 모델 파라미터 수: 43,204 개
2026-02-26 22:31:38,687 - INFO -   - Encoder (Encoder):         2,953 개
2026-02-26 22:31:38,687 - INFO -     - conv_front (CNN Backbone):        2,935 개
2026-02-26 22:31:38,687 - INFO -     - 1x1_conv (Channel Proj):          0 개
2026-02-26 22:31:38,687 - INFO -     - norm (LayerNorm):                 18 개
2026-02-26 22:31:38,687 - INFO -   - Decoder (Cross-Attention-based):    35,488 개
2026-02-26 22:31:38,687 - INFO -     - Embedding Layer (feat_to_emb):   320 개
2026-02-26 22:31:38,687 - INFO -     - Init Key Proj (W_K_init):         1,056 개
2026-02-26 22:31:38,687 - INFO -     - Init Value Proj (W_V_init):       1,056 개
2026-02-26 22:31:38,687 - INFO -     - Learnable Queries:                224 개
2026-02-26 22:31:38,687 - INFO -     - Decoder Layers:                   32,832 개
2026-02-26 22:31:38,687 - INFO -   - Classifier (Projection MLP):        4,763 개
2026-02-26 22:31:38,687 - INFO - Pruning 이후 finetuning_pruned 설정으로 미세 조정을 수행합니다.
2026-02-26 22:31:38,687 - INFO - 옵티마이저: AdamW (lr=0.001, weight_decay=0.0001)
2026-02-26 22:31:38,687 - INFO - 스케줄러: CosineAnnealingLR (T_max=80, eta_min=0.0001)
2026-02-26 22:31:38,687 - INFO - ==================================================
2026-02-26 22:31:38,687 - INFO - train 모드를 시작합니다.
2026-02-26 22:31:38,688 - INFO - 손실 함수: CrossEntropyLoss (label_smoothing: 0.1)
2026-02-26 22:31:38,688 - INFO - --------------------------------------------------
2026-02-26 22:31:38,688 - INFO - [LR]    [1/80] | Learning Rate: 0.001000
2026-02-26 22:31:43,377 - INFO - [Train] [1/80] | Loss: 0.5417 | Train Acc: 76.71%
2026-02-26 22:31:44,825 - INFO - [Valid] [1/80] | Loss: 0.5473 | Val Acc: 75.81%
2026-02-26 22:31:44,836 - INFO - [Metrics for 'abnormal'] | Precision: 0.7483 | Recall: 0.7197 | F1: 0.7338
2026-02-26 22:31:44,836 - INFO - [Metrics for 'normal'] | Precision: 0.7660 | Recall: 0.7912 | F1: 0.7784
2026-02-26 22:31:44,851 - INFO - [Best Model Saved] (val loss: 0.5473) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:44,851 - INFO - --------------------------------------------------
2026-02-26 22:31:44,851 - INFO - [LR]    [2/80] | Learning Rate: 0.001000
2026-02-26 22:31:48,992 - INFO - [Train] [2/80] | Loss: 0.4973 | Train Acc: 80.13%
2026-02-26 22:31:50,321 - INFO - [Valid] [2/80] | Loss: 0.5436 | Val Acc: 77.29%
2026-02-26 22:31:50,333 - INFO - [Metrics for 'abnormal'] | Precision: 0.7410 | Recall: 0.7834 | F1: 0.7616
2026-02-26 22:31:50,333 - INFO - [Metrics for 'normal'] | Precision: 0.8035 | Recall: 0.7637 | F1: 0.7831
2026-02-26 22:31:50,347 - INFO - [Best Model Saved] (val loss: 0.5436) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:50,349 - INFO - --------------------------------------------------
2026-02-26 22:31:50,349 - INFO - [LR]    [3/80] | Learning Rate: 0.000999
2026-02-26 22:31:54,664 - INFO - [Train] [3/80] | Loss: 0.4843 | Train Acc: 81.85%
2026-02-26 22:31:56,239 - INFO - [Valid] [3/80] | Loss: 0.5335 | Val Acc: 75.81%
2026-02-26 22:31:56,251 - INFO - [Metrics for 'abnormal'] | Precision: 0.6963 | Recall: 0.8471 | F1: 0.7644
2026-02-26 22:31:56,255 - INFO - [Metrics for 'normal'] | Precision: 0.8378 | Recall: 0.6813 | F1: 0.7515
2026-02-26 22:31:56,267 - INFO - [Best Model Saved] (val loss: 0.5335) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:31:56,270 - INFO - --------------------------------------------------
2026-02-26 22:31:56,270 - INFO - [LR]    [4/80] | Learning Rate: 0.000997
2026-02-26 22:32:00,417 - INFO - [Train] [4/80] | Loss: 0.4753 | Train Acc: 82.74%
2026-02-26 22:32:01,606 - INFO - [Valid] [4/80] | Loss: 0.5168 | Val Acc: 78.76%
2026-02-26 22:32:01,610 - INFO - [Metrics for 'abnormal'] | Precision: 0.7640 | Recall: 0.7834 | F1: 0.7736
2026-02-26 22:32:01,610 - INFO - [Metrics for 'normal'] | Precision: 0.8090 | Recall: 0.7912 | F1: 0.8000
2026-02-26 22:32:01,618 - INFO - [Best Model Saved] (val loss: 0.5168) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:32:01,618 - INFO - --------------------------------------------------
2026-02-26 22:32:01,618 - INFO - [LR]    [5/80] | Learning Rate: 0.000994
2026-02-26 22:32:06,338 - INFO - [Train] [5/80] | Loss: 0.4807 | Train Acc: 80.88%
2026-02-26 22:32:07,604 - INFO - [Valid] [5/80] | Loss: 0.5133 | Val Acc: 77.29%
2026-02-26 22:32:07,611 - INFO - [Metrics for 'abnormal'] | Precision: 0.7469 | Recall: 0.7707 | F1: 0.7586
2026-02-26 22:32:07,615 - INFO - [Metrics for 'normal'] | Precision: 0.7966 | Recall: 0.7747 | F1: 0.7855
2026-02-26 22:32:07,633 - INFO - [Best Model Saved] (val loss: 0.5133) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:32:07,633 - INFO - --------------------------------------------------
2026-02-26 22:32:07,634 - INFO - [LR]    [6/80] | Learning Rate: 0.000991
2026-02-26 22:32:12,057 - INFO - [Train] [6/80] | Loss: 0.4722 | Train Acc: 82.66%
2026-02-26 22:32:13,475 - INFO - [Valid] [6/80] | Loss: 0.5236 | Val Acc: 78.76%
2026-02-26 22:32:13,485 - INFO - [Metrics for 'abnormal'] | Precision: 0.8295 | Recall: 0.6815 | F1: 0.7483
2026-02-26 22:32:13,488 - INFO - [Metrics for 'normal'] | Precision: 0.7619 | Recall: 0.8791 | F1: 0.8163
2026-02-26 22:32:13,488 - INFO - --------------------------------------------------
2026-02-26 22:32:13,488 - INFO - [LR]    [7/80] | Learning Rate: 0.000988
2026-02-26 22:32:18,010 - INFO - [Train] [7/80] | Loss: 0.4654 | Train Acc: 83.48%
2026-02-26 22:32:19,327 - INFO - [Valid] [7/80] | Loss: 0.6024 | Val Acc: 75.22%
2026-02-26 22:32:19,331 - INFO - [Metrics for 'abnormal'] | Precision: 0.6798 | Recall: 0.8790 | F1: 0.7667
2026-02-26 22:32:19,332 - INFO - [Metrics for 'normal'] | Precision: 0.8603 | Recall: 0.6429 | F1: 0.7358
2026-02-26 22:32:19,332 - INFO - --------------------------------------------------
2026-02-26 22:32:19,332 - INFO - [LR]    [8/80] | Learning Rate: 0.000983
2026-02-26 22:32:23,622 - INFO - [Train] [8/80] | Loss: 0.4611 | Train Acc: 84.00%
2026-02-26 22:32:24,834 - INFO - [Valid] [8/80] | Loss: 0.5205 | Val Acc: 79.06%
2026-02-26 22:32:24,842 - INFO - [Metrics for 'abnormal'] | Precision: 0.7416 | Recall: 0.8408 | F1: 0.7881
2026-02-26 22:32:24,845 - INFO - [Metrics for 'normal'] | Precision: 0.8447 | Recall: 0.7473 | F1: 0.7930
2026-02-26 22:32:24,845 - INFO - --------------------------------------------------
2026-02-26 22:32:24,845 - INFO - [LR]    [9/80] | Learning Rate: 0.000978
2026-02-26 22:32:29,593 - INFO - [Train] [9/80] | Loss: 0.4481 | Train Acc: 84.52%
2026-02-26 22:32:30,927 - INFO - [Valid] [9/80] | Loss: 0.5182 | Val Acc: 79.94%
2026-02-26 22:32:30,938 - INFO - [Metrics for 'abnormal'] | Precision: 0.8397 | Recall: 0.7006 | F1: 0.7639
2026-02-26 22:32:30,940 - INFO - [Metrics for 'normal'] | Precision: 0.7740 | Recall: 0.8846 | F1: 0.8256
2026-02-26 22:32:30,940 - INFO - --------------------------------------------------
2026-02-26 22:32:30,940 - INFO - [LR]    [10/80] | Learning Rate: 0.000972
2026-02-26 22:32:35,424 - INFO - [Train] [10/80] | Loss: 0.4550 | Train Acc: 84.97%
2026-02-26 22:32:36,898 - INFO - [Valid] [10/80] | Loss: 0.5138 | Val Acc: 80.24%
2026-02-26 22:32:36,903 - INFO - [Metrics for 'abnormal'] | Precision: 0.7885 | Recall: 0.7834 | F1: 0.7859
2026-02-26 22:32:36,903 - INFO - [Metrics for 'normal'] | Precision: 0.8142 | Recall: 0.8187 | F1: 0.8164
2026-02-26 22:32:36,903 - INFO - --------------------------------------------------
2026-02-26 22:32:36,903 - INFO - [LR]    [11/80] | Learning Rate: 0.000966
2026-02-26 22:32:41,293 - INFO - [Train] [11/80] | Loss: 0.4528 | Train Acc: 83.85%
2026-02-26 22:32:42,945 - INFO - [Valid] [11/80] | Loss: 0.4944 | Val Acc: 81.12%
2026-02-26 22:32:42,955 - INFO - [Metrics for 'abnormal'] | Precision: 0.7657 | Recall: 0.8535 | F1: 0.8072
2026-02-26 22:32:42,955 - INFO - [Metrics for 'normal'] | Precision: 0.8598 | Recall: 0.7747 | F1: 0.8150
2026-02-26 22:32:42,981 - INFO - [Best Model Saved] (val loss: 0.4944) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:32:42,981 - INFO - --------------------------------------------------
2026-02-26 22:32:42,981 - INFO - [LR]    [12/80] | Learning Rate: 0.000959
2026-02-26 22:32:46,958 - INFO - [Train] [12/80] | Loss: 0.4513 | Train Acc: 84.75%
2026-02-26 22:32:48,435 - INFO - [Valid] [12/80] | Loss: 0.4867 | Val Acc: 81.71%
2026-02-26 22:32:48,453 - INFO - [Metrics for 'abnormal'] | Precision: 0.8467 | Recall: 0.7389 | F1: 0.7891
2026-02-26 22:32:48,454 - INFO - [Metrics for 'normal'] | Precision: 0.7970 | Recall: 0.8846 | F1: 0.8385
2026-02-26 22:32:48,480 - INFO - [Best Model Saved] (val loss: 0.4867) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:32:48,481 - INFO - --------------------------------------------------
2026-02-26 22:32:48,482 - INFO - [LR]    [13/80] | Learning Rate: 0.000951
2026-02-26 22:32:53,202 - INFO - [Train] [13/80] | Loss: 0.4382 | Train Acc: 85.12%
2026-02-26 22:32:54,963 - INFO - [Valid] [13/80] | Loss: 0.5536 | Val Acc: 77.58%
2026-02-26 22:32:54,974 - INFO - [Metrics for 'abnormal'] | Precision: 0.7098 | Recall: 0.8726 | F1: 0.7829
2026-02-26 22:32:54,981 - INFO - [Metrics for 'normal'] | Precision: 0.8630 | Recall: 0.6923 | F1: 0.7683
2026-02-26 22:32:54,982 - INFO - --------------------------------------------------
2026-02-26 22:32:54,982 - INFO - [LR]    [14/80] | Learning Rate: 0.000943
2026-02-26 22:32:59,479 - INFO - [Train] [14/80] | Loss: 0.4315 | Train Acc: 84.82%
2026-02-26 22:33:01,195 - INFO - [Valid] [14/80] | Loss: 0.5203 | Val Acc: 81.12%
2026-02-26 22:33:01,200 - INFO - [Metrics for 'abnormal'] | Precision: 0.7541 | Recall: 0.8790 | F1: 0.8118
2026-02-26 22:33:01,200 - INFO - [Metrics for 'normal'] | Precision: 0.8782 | Recall: 0.7527 | F1: 0.8107
2026-02-26 22:33:01,200 - INFO - --------------------------------------------------
2026-02-26 22:33:01,200 - INFO - [LR]    [15/80] | Learning Rate: 0.000934
2026-02-26 22:33:05,324 - INFO - [Train] [15/80] | Loss: 0.4365 | Train Acc: 84.67%
2026-02-26 22:33:06,993 - INFO - [Valid] [15/80] | Loss: 0.4801 | Val Acc: 83.48%
2026-02-26 22:33:07,011 - INFO - [Metrics for 'abnormal'] | Precision: 0.8389 | Recall: 0.7962 | F1: 0.8170
2026-02-26 22:33:07,012 - INFO - [Metrics for 'normal'] | Precision: 0.8316 | Recall: 0.8681 | F1: 0.8495
2026-02-26 22:33:07,044 - INFO - [Best Model Saved] (val loss: 0.4801) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:33:07,048 - INFO - --------------------------------------------------
2026-02-26 22:33:07,048 - INFO - [LR]    [16/80] | Learning Rate: 0.000924
2026-02-26 22:33:11,053 - INFO - [Train] [16/80] | Loss: 0.4452 | Train Acc: 84.08%
2026-02-26 22:33:12,423 - INFO - [Valid] [16/80] | Loss: 0.4881 | Val Acc: 83.48%
2026-02-26 22:33:12,433 - INFO - [Metrics for 'abnormal'] | Precision: 0.8435 | Recall: 0.7898 | F1: 0.8158
2026-02-26 22:33:12,434 - INFO - [Metrics for 'normal'] | Precision: 0.8281 | Recall: 0.8736 | F1: 0.8503
2026-02-26 22:33:12,434 - INFO - --------------------------------------------------
2026-02-26 22:33:12,434 - INFO - [LR]    [17/80] | Learning Rate: 0.000914
2026-02-26 22:33:17,192 - INFO - [Train] [17/80] | Loss: 0.4373 | Train Acc: 84.60%
2026-02-26 22:33:18,778 - INFO - [Valid] [17/80] | Loss: 0.5865 | Val Acc: 76.99%
2026-02-26 22:33:18,784 - INFO - [Metrics for 'abnormal'] | Precision: 0.6946 | Recall: 0.8981 | F1: 0.7833
2026-02-26 22:33:18,784 - INFO - [Metrics for 'normal'] | Precision: 0.8824 | Recall: 0.6593 | F1: 0.7547
2026-02-26 22:33:18,784 - INFO - --------------------------------------------------
2026-02-26 22:33:18,785 - INFO - [LR]    [18/80] | Learning Rate: 0.000903
2026-02-26 22:33:22,814 - INFO - [Train] [18/80] | Loss: 0.4323 | Train Acc: 84.52%
2026-02-26 22:33:24,490 - INFO - [Valid] [18/80] | Loss: 0.5102 | Val Acc: 82.89%
2026-02-26 22:33:24,508 - INFO - [Metrics for 'abnormal'] | Precision: 0.8511 | Recall: 0.7643 | F1: 0.8054
2026-02-26 22:33:24,508 - INFO - [Metrics for 'normal'] | Precision: 0.8131 | Recall: 0.8846 | F1: 0.8474
2026-02-26 22:33:24,508 - INFO - --------------------------------------------------
2026-02-26 22:33:24,508 - INFO - [LR]    [19/80] | Learning Rate: 0.000892
2026-02-26 22:33:28,993 - INFO - [Train] [19/80] | Loss: 0.4176 | Train Acc: 85.49%
2026-02-26 22:33:30,643 - INFO - [Valid] [19/80] | Loss: 0.4715 | Val Acc: 83.48%
2026-02-26 22:33:30,648 - INFO - [Metrics for 'abnormal'] | Precision: 0.8176 | Recall: 0.8280 | F1: 0.8228
2026-02-26 22:33:30,648 - INFO - [Metrics for 'normal'] | Precision: 0.8500 | Recall: 0.8407 | F1: 0.8453
2026-02-26 22:33:30,657 - INFO - [Best Model Saved] (val loss: 0.4715) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:33:30,658 - INFO - --------------------------------------------------
2026-02-26 22:33:30,658 - INFO - [LR]    [20/80] | Learning Rate: 0.000880
2026-02-26 22:33:34,589 - INFO - [Train] [20/80] | Loss: 0.4120 | Train Acc: 87.28%
2026-02-26 22:33:36,241 - INFO - [Valid] [20/80] | Loss: 0.4781 | Val Acc: 79.35%
2026-02-26 22:33:36,245 - INFO - [Metrics for 'abnormal'] | Precision: 0.7326 | Recall: 0.8726 | F1: 0.7965
2026-02-26 22:33:36,245 - INFO - [Metrics for 'normal'] | Precision: 0.8684 | Recall: 0.7253 | F1: 0.7904
2026-02-26 22:33:36,245 - INFO - --------------------------------------------------
2026-02-26 22:33:36,245 - INFO - [LR]    [21/80] | Learning Rate: 0.000868
2026-02-26 22:33:40,387 - INFO - [Train] [21/80] | Loss: 0.4140 | Train Acc: 86.38%
2026-02-26 22:33:41,945 - INFO - [Valid] [21/80] | Loss: 0.4939 | Val Acc: 81.12%
2026-02-26 22:33:41,950 - INFO - [Metrics for 'abnormal'] | Precision: 0.7751 | Recall: 0.8344 | F1: 0.8037
2026-02-26 22:33:41,950 - INFO - [Metrics for 'normal'] | Precision: 0.8471 | Recall: 0.7912 | F1: 0.8182
2026-02-26 22:33:41,950 - INFO - --------------------------------------------------
2026-02-26 22:33:41,950 - INFO - [LR]    [22/80] | Learning Rate: 0.000855
2026-02-26 22:33:45,778 - INFO - [Train] [22/80] | Loss: 0.4096 | Train Acc: 86.76%
2026-02-26 22:33:47,624 - INFO - [Valid] [22/80] | Loss: 0.4782 | Val Acc: 83.19%
2026-02-26 22:33:47,651 - INFO - [Metrics for 'abnormal'] | Precision: 0.8333 | Recall: 0.7962 | F1: 0.8143
2026-02-26 22:33:47,651 - INFO - [Metrics for 'normal'] | Precision: 0.8307 | Recall: 0.8626 | F1: 0.8464
2026-02-26 22:33:47,651 - INFO - --------------------------------------------------
2026-02-26 22:33:47,651 - INFO - [LR]    [23/80] | Learning Rate: 0.000842
2026-02-26 22:33:52,145 - INFO - [Train] [23/80] | Loss: 0.4028 | Train Acc: 87.72%
2026-02-26 22:33:53,737 - INFO - [Valid] [23/80] | Loss: 0.4765 | Val Acc: 82.30%
2026-02-26 22:33:53,747 - INFO - [Metrics for 'abnormal'] | Precision: 0.7975 | Recall: 0.8280 | F1: 0.8125
2026-02-26 22:33:53,749 - INFO - [Metrics for 'normal'] | Precision: 0.8466 | Recall: 0.8187 | F1: 0.8324
2026-02-26 22:33:53,749 - INFO - --------------------------------------------------
2026-02-26 22:33:53,749 - INFO - [LR]    [24/80] | Learning Rate: 0.000829
2026-02-26 22:33:58,224 - INFO - [Train] [24/80] | Loss: 0.3999 | Train Acc: 86.68%
2026-02-26 22:33:59,604 - INFO - [Valid] [24/80] | Loss: 0.4683 | Val Acc: 84.96%
2026-02-26 22:33:59,606 - INFO - [Metrics for 'abnormal'] | Precision: 0.8487 | Recall: 0.8217 | F1: 0.8350
2026-02-26 22:33:59,606 - INFO - [Metrics for 'normal'] | Precision: 0.8503 | Recall: 0.8736 | F1: 0.8618
2026-02-26 22:33:59,615 - INFO - [Best Model Saved] (val loss: 0.4683) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:33:59,615 - INFO - --------------------------------------------------
2026-02-26 22:33:59,615 - INFO - [LR]    [25/80] | Learning Rate: 0.000815
2026-02-26 22:34:03,678 - INFO - [Train] [25/80] | Loss: 0.3951 | Train Acc: 87.87%
2026-02-26 22:34:05,140 - INFO - [Valid] [25/80] | Loss: 0.4857 | Val Acc: 81.71%
2026-02-26 22:34:05,145 - INFO - [Metrics for 'abnormal'] | Precision: 0.8467 | Recall: 0.7389 | F1: 0.7891
2026-02-26 22:34:05,145 - INFO - [Metrics for 'normal'] | Precision: 0.7970 | Recall: 0.8846 | F1: 0.8385
2026-02-26 22:34:05,145 - INFO - --------------------------------------------------
2026-02-26 22:34:05,145 - INFO - [LR]    [26/80] | Learning Rate: 0.000800
2026-02-26 22:34:09,288 - INFO - [Train] [26/80] | Loss: 0.3893 | Train Acc: 87.72%
2026-02-26 22:34:10,991 - INFO - [Valid] [26/80] | Loss: 0.4934 | Val Acc: 81.42%
2026-02-26 22:34:11,002 - INFO - [Metrics for 'abnormal'] | Precision: 0.7765 | Recall: 0.8408 | F1: 0.8073
2026-02-26 22:34:11,002 - INFO - [Metrics for 'normal'] | Precision: 0.8521 | Recall: 0.7912 | F1: 0.8205
2026-02-26 22:34:11,005 - INFO - --------------------------------------------------
2026-02-26 22:34:11,005 - INFO - [LR]    [27/80] | Learning Rate: 0.000785
2026-02-26 22:34:15,177 - INFO - [Train] [27/80] | Loss: 0.4029 | Train Acc: 87.72%
2026-02-26 22:34:16,761 - INFO - [Valid] [27/80] | Loss: 0.4831 | Val Acc: 82.89%
2026-02-26 22:34:16,766 - INFO - [Metrics for 'abnormal'] | Precision: 0.7705 | Recall: 0.8981 | F1: 0.8294
2026-02-26 22:34:16,766 - INFO - [Metrics for 'normal'] | Precision: 0.8974 | Recall: 0.7692 | F1: 0.8284
2026-02-26 22:34:16,766 - INFO - --------------------------------------------------
2026-02-26 22:34:16,766 - INFO - [LR]    [28/80] | Learning Rate: 0.000770
2026-02-26 22:34:20,973 - INFO - [Train] [28/80] | Loss: 0.3948 | Train Acc: 87.50%
2026-02-26 22:34:22,663 - INFO - [Valid] [28/80] | Loss: 0.5141 | Val Acc: 81.12%
2026-02-26 22:34:22,668 - INFO - [Metrics for 'abnormal'] | Precision: 0.7460 | Recall: 0.8981 | F1: 0.8150
2026-02-26 22:34:22,668 - INFO - [Metrics for 'normal'] | Precision: 0.8933 | Recall: 0.7363 | F1: 0.8072
2026-02-26 22:34:22,668 - INFO - --------------------------------------------------
2026-02-26 22:34:22,668 - INFO - [LR]    [29/80] | Learning Rate: 0.000754
2026-02-26 22:34:26,870 - INFO - [Train] [29/80] | Loss: 0.3940 | Train Acc: 88.02%
2026-02-26 22:34:28,518 - INFO - [Valid] [29/80] | Loss: 0.5291 | Val Acc: 78.47%
2026-02-26 22:34:28,523 - INFO - [Metrics for 'abnormal'] | Precision: 0.7763 | Recall: 0.7516 | F1: 0.7638
2026-02-26 22:34:28,524 - INFO - [Metrics for 'normal'] | Precision: 0.7914 | Recall: 0.8132 | F1: 0.8022
2026-02-26 22:34:28,524 - INFO - --------------------------------------------------
2026-02-26 22:34:28,524 - INFO - [LR]    [30/80] | Learning Rate: 0.000738
2026-02-26 22:34:33,417 - INFO - [Train] [30/80] | Loss: 0.3899 | Train Acc: 88.02%
2026-02-26 22:34:34,448 - INFO - [Valid] [30/80] | Loss: 0.5103 | Val Acc: 81.71%
2026-02-26 22:34:34,457 - INFO - [Metrics for 'abnormal'] | Precision: 0.8369 | Recall: 0.7516 | F1: 0.7919
2026-02-26 22:34:34,458 - INFO - [Metrics for 'normal'] | Precision: 0.8030 | Recall: 0.8736 | F1: 0.8368
2026-02-26 22:34:34,461 - INFO - --------------------------------------------------
2026-02-26 22:34:34,461 - INFO - [LR]    [31/80] | Learning Rate: 0.000722
2026-02-26 22:34:39,267 - INFO - [Train] [31/80] | Loss: 0.3861 | Train Acc: 88.76%
2026-02-26 22:34:40,416 - INFO - [Valid] [31/80] | Loss: 0.4815 | Val Acc: 81.71%
2026-02-26 22:34:40,432 - INFO - [Metrics for 'abnormal'] | Precision: 0.7778 | Recall: 0.8471 | F1: 0.8110
2026-02-26 22:34:40,432 - INFO - [Metrics for 'normal'] | Precision: 0.8571 | Recall: 0.7912 | F1: 0.8229
2026-02-26 22:34:40,432 - INFO - --------------------------------------------------
2026-02-26 22:34:40,433 - INFO - [LR]    [32/80] | Learning Rate: 0.000706
2026-02-26 22:34:45,000 - INFO - [Train] [32/80] | Loss: 0.3851 | Train Acc: 88.32%
2026-02-26 22:34:46,157 - INFO - [Valid] [32/80] | Loss: 0.4860 | Val Acc: 82.60%
2026-02-26 22:34:46,160 - INFO - [Metrics for 'abnormal'] | Precision: 0.7753 | Recall: 0.8790 | F1: 0.8239
2026-02-26 22:34:46,160 - INFO - [Metrics for 'normal'] | Precision: 0.8820 | Recall: 0.7802 | F1: 0.8280
2026-02-26 22:34:46,160 - INFO - --------------------------------------------------
2026-02-26 22:34:46,160 - INFO - [LR]    [33/80] | Learning Rate: 0.000689
2026-02-26 22:34:51,070 - INFO - [Train] [33/80] | Loss: 0.3839 | Train Acc: 88.32%
2026-02-26 22:34:52,178 - INFO - [Valid] [33/80] | Loss: 0.4777 | Val Acc: 82.60%
2026-02-26 22:34:52,182 - INFO - [Metrics for 'abnormal'] | Precision: 0.7634 | Recall: 0.9045 | F1: 0.8280
2026-02-26 22:34:52,182 - INFO - [Metrics for 'normal'] | Precision: 0.9020 | Recall: 0.7582 | F1: 0.8239
2026-02-26 22:34:52,182 - INFO - --------------------------------------------------
2026-02-26 22:34:52,182 - INFO - [LR]    [34/80] | Learning Rate: 0.000672
2026-02-26 22:34:57,180 - INFO - [Train] [34/80] | Loss: 0.3809 | Train Acc: 88.62%
2026-02-26 22:34:58,268 - INFO - [Valid] [34/80] | Loss: 0.4421 | Val Acc: 83.48%
2026-02-26 22:34:58,273 - INFO - [Metrics for 'abnormal'] | Precision: 0.8176 | Recall: 0.8280 | F1: 0.8228
2026-02-26 22:34:58,274 - INFO - [Metrics for 'normal'] | Precision: 0.8500 | Recall: 0.8407 | F1: 0.8453
2026-02-26 22:34:58,283 - INFO - [Best Model Saved] (val loss: 0.4421) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:34:58,283 - INFO - --------------------------------------------------
2026-02-26 22:34:58,283 - INFO - [LR]    [35/80] | Learning Rate: 0.000655
2026-02-26 22:35:03,180 - INFO - [Train] [35/80] | Loss: 0.3788 | Train Acc: 88.91%
2026-02-26 22:35:04,134 - INFO - [Valid] [35/80] | Loss: 0.4529 | Val Acc: 82.30%
2026-02-26 22:35:04,137 - INFO - [Metrics for 'abnormal'] | Precision: 0.7870 | Recall: 0.8471 | F1: 0.8160
2026-02-26 22:35:04,137 - INFO - [Metrics for 'normal'] | Precision: 0.8588 | Recall: 0.8022 | F1: 0.8295
2026-02-26 22:35:04,137 - INFO - --------------------------------------------------
2026-02-26 22:35:04,137 - INFO - [LR]    [36/80] | Learning Rate: 0.000638
2026-02-26 22:35:08,805 - INFO - [Train] [36/80] | Loss: 0.3894 | Train Acc: 86.98%
2026-02-26 22:35:09,622 - INFO - [Valid] [36/80] | Loss: 0.5067 | Val Acc: 81.71%
2026-02-26 22:35:09,626 - INFO - [Metrics for 'abnormal'] | Precision: 0.7654 | Recall: 0.8726 | F1: 0.8155
2026-02-26 22:35:09,626 - INFO - [Metrics for 'normal'] | Precision: 0.8750 | Recall: 0.7692 | F1: 0.8187
2026-02-26 22:35:09,626 - INFO - --------------------------------------------------
2026-02-26 22:35:09,627 - INFO - [LR]    [37/80] | Learning Rate: 0.000620
2026-02-26 22:35:14,463 - INFO - [Train] [37/80] | Loss: 0.3784 | Train Acc: 87.87%
2026-02-26 22:35:15,547 - INFO - [Valid] [37/80] | Loss: 0.4761 | Val Acc: 82.30%
2026-02-26 22:35:15,551 - INFO - [Metrics for 'abnormal'] | Precision: 0.7904 | Recall: 0.8408 | F1: 0.8148
2026-02-26 22:35:15,551 - INFO - [Metrics for 'normal'] | Precision: 0.8547 | Recall: 0.8077 | F1: 0.8305
2026-02-26 22:35:15,551 - INFO - --------------------------------------------------
2026-02-26 22:35:15,551 - INFO - [LR]    [38/80] | Learning Rate: 0.000603
2026-02-26 22:35:19,878 - INFO - [Train] [38/80] | Loss: 0.3751 | Train Acc: 88.84%
2026-02-26 22:35:21,168 - INFO - [Valid] [38/80] | Loss: 0.4762 | Val Acc: 84.66%
2026-02-26 22:35:21,172 - INFO - [Metrics for 'abnormal'] | Precision: 0.8035 | Recall: 0.8854 | F1: 0.8424
2026-02-26 22:35:21,172 - INFO - [Metrics for 'normal'] | Precision: 0.8916 | Recall: 0.8132 | F1: 0.8506
2026-02-26 22:35:21,172 - INFO - --------------------------------------------------
2026-02-26 22:35:21,172 - INFO - [LR]    [39/80] | Learning Rate: 0.000585
2026-02-26 22:35:25,588 - INFO - [Train] [39/80] | Loss: 0.3689 | Train Acc: 88.76%
2026-02-26 22:35:26,605 - INFO - [Valid] [39/80] | Loss: 0.4834 | Val Acc: 83.78%
2026-02-26 22:35:26,610 - INFO - [Metrics for 'abnormal'] | Precision: 0.8355 | Recall: 0.8089 | F1: 0.8220
2026-02-26 22:35:26,610 - INFO - [Metrics for 'normal'] | Precision: 0.8396 | Recall: 0.8626 | F1: 0.8509
2026-02-26 22:35:26,610 - INFO - --------------------------------------------------
2026-02-26 22:35:26,610 - INFO - [LR]    [40/80] | Learning Rate: 0.000568
2026-02-26 22:35:31,553 - INFO - [Train] [40/80] | Loss: 0.3582 | Train Acc: 90.18%
2026-02-26 22:35:32,613 - INFO - [Valid] [40/80] | Loss: 0.4515 | Val Acc: 83.19%
2026-02-26 22:35:32,616 - INFO - [Metrics for 'abnormal'] | Precision: 0.7809 | Recall: 0.8854 | F1: 0.8299
2026-02-26 22:35:32,617 - INFO - [Metrics for 'normal'] | Precision: 0.8882 | Recall: 0.7857 | F1: 0.8338
2026-02-26 22:35:32,617 - INFO - --------------------------------------------------
2026-02-26 22:35:32,617 - INFO - [LR]    [41/80] | Learning Rate: 0.000550
2026-02-26 22:35:37,717 - INFO - [Train] [41/80] | Loss: 0.3629 | Train Acc: 89.88%
2026-02-26 22:35:38,727 - INFO - [Valid] [41/80] | Loss: 0.5209 | Val Acc: 82.60%
2026-02-26 22:35:38,737 - INFO - [Metrics for 'abnormal'] | Precision: 0.8063 | Recall: 0.8217 | F1: 0.8139
2026-02-26 22:35:38,741 - INFO - [Metrics for 'normal'] | Precision: 0.8436 | Recall: 0.8297 | F1: 0.8366
2026-02-26 22:35:38,741 - INFO - --------------------------------------------------
2026-02-26 22:35:38,741 - INFO - [LR]    [42/80] | Learning Rate: 0.000532
2026-02-26 22:35:43,735 - INFO - [Train] [42/80] | Loss: 0.3638 | Train Acc: 89.81%
2026-02-26 22:35:44,815 - INFO - [Valid] [42/80] | Loss: 0.4552 | Val Acc: 84.07%
2026-02-26 22:35:44,820 - INFO - [Metrics for 'abnormal'] | Precision: 0.8084 | Recall: 0.8599 | F1: 0.8333
2026-02-26 22:35:44,821 - INFO - [Metrics for 'normal'] | Precision: 0.8721 | Recall: 0.8242 | F1: 0.8475
2026-02-26 22:35:44,821 - INFO - --------------------------------------------------
2026-02-26 22:35:44,821 - INFO - [LR]    [43/80] | Learning Rate: 0.000515
2026-02-26 22:35:49,097 - INFO - [Train] [43/80] | Loss: 0.3615 | Train Acc: 89.14%
2026-02-26 22:35:50,198 - INFO - [Valid] [43/80] | Loss: 0.4592 | Val Acc: 83.78%
2026-02-26 22:35:50,201 - INFO - [Metrics for 'abnormal'] | Precision: 0.8072 | Recall: 0.8535 | F1: 0.8297
2026-02-26 22:35:50,202 - INFO - [Metrics for 'normal'] | Precision: 0.8671 | Recall: 0.8242 | F1: 0.8451
2026-02-26 22:35:50,202 - INFO - --------------------------------------------------
2026-02-26 22:35:50,202 - INFO - [LR]    [44/80] | Learning Rate: 0.000497
2026-02-26 22:35:54,915 - INFO - [Train] [44/80] | Loss: 0.3628 | Train Acc: 89.58%
2026-02-26 22:35:56,058 - INFO - [Valid] [44/80] | Loss: 0.4901 | Val Acc: 84.66%
2026-02-26 22:35:56,060 - INFO - [Metrics for 'abnormal'] | Precision: 0.8621 | Recall: 0.7962 | F1: 0.8278
2026-02-26 22:35:56,060 - INFO - [Metrics for 'normal'] | Precision: 0.8351 | Recall: 0.8901 | F1: 0.8617
2026-02-26 22:35:56,060 - INFO - --------------------------------------------------
2026-02-26 22:35:56,060 - INFO - [LR]    [45/80] | Learning Rate: 0.000480
2026-02-26 22:36:00,790 - INFO - [Train] [45/80] | Loss: 0.3604 | Train Acc: 89.43%
2026-02-26 22:36:01,949 - INFO - [Valid] [45/80] | Loss: 0.4650 | Val Acc: 82.60%
2026-02-26 22:36:01,970 - INFO - [Metrics for 'abnormal'] | Precision: 0.8025 | Recall: 0.8280 | F1: 0.8150
2026-02-26 22:36:01,971 - INFO - [Metrics for 'normal'] | Precision: 0.8475 | Recall: 0.8242 | F1: 0.8357
2026-02-26 22:36:01,971 - INFO - --------------------------------------------------
2026-02-26 22:36:01,971 - INFO - [LR]    [46/80] | Learning Rate: 0.000462
2026-02-26 22:36:06,365 - INFO - [Train] [46/80] | Loss: 0.3660 | Train Acc: 88.91%
2026-02-26 22:36:07,555 - INFO - [Valid] [46/80] | Loss: 0.4549 | Val Acc: 83.48%
2026-02-26 22:36:07,557 - INFO - [Metrics for 'abnormal'] | Precision: 0.8098 | Recall: 0.8408 | F1: 0.8250
2026-02-26 22:36:07,557 - INFO - [Metrics for 'normal'] | Precision: 0.8580 | Recall: 0.8297 | F1: 0.8436
2026-02-26 22:36:07,557 - INFO - --------------------------------------------------
2026-02-26 22:36:07,557 - INFO - [LR]    [47/80] | Learning Rate: 0.000445
2026-02-26 22:36:12,394 - INFO - [Train] [47/80] | Loss: 0.3600 | Train Acc: 89.51%
2026-02-26 22:36:13,406 - INFO - [Valid] [47/80] | Loss: 0.4888 | Val Acc: 81.12%
2026-02-26 22:36:13,409 - INFO - [Metrics for 'abnormal'] | Precision: 0.7818 | Recall: 0.8217 | F1: 0.8012
2026-02-26 22:36:13,409 - INFO - [Metrics for 'normal'] | Precision: 0.8391 | Recall: 0.8022 | F1: 0.8202
2026-02-26 22:36:13,409 - INFO - --------------------------------------------------
2026-02-26 22:36:13,409 - INFO - [LR]    [48/80] | Learning Rate: 0.000428
2026-02-26 22:36:18,068 - INFO - [Train] [48/80] | Loss: 0.3555 | Train Acc: 89.96%
2026-02-26 22:36:19,273 - INFO - [Valid] [48/80] | Loss: 0.4579 | Val Acc: 83.78%
2026-02-26 22:36:19,277 - INFO - [Metrics for 'abnormal'] | Precision: 0.8148 | Recall: 0.8408 | F1: 0.8276
2026-02-26 22:36:19,277 - INFO - [Metrics for 'normal'] | Precision: 0.8588 | Recall: 0.8352 | F1: 0.8468
2026-02-26 22:36:19,277 - INFO - --------------------------------------------------
2026-02-26 22:36:19,277 - INFO - [LR]    [49/80] | Learning Rate: 0.000411
2026-02-26 22:36:24,382 - INFO - [Train] [49/80] | Loss: 0.3536 | Train Acc: 89.96%
2026-02-26 22:36:25,589 - INFO - [Valid] [49/80] | Loss: 0.4438 | Val Acc: 83.19%
2026-02-26 22:36:25,595 - INFO - [Metrics for 'abnormal'] | Precision: 0.8086 | Recall: 0.8344 | F1: 0.8213
2026-02-26 22:36:25,599 - INFO - [Metrics for 'normal'] | Precision: 0.8531 | Recall: 0.8297 | F1: 0.8412
2026-02-26 22:36:25,599 - INFO - --------------------------------------------------
2026-02-26 22:36:25,599 - INFO - [LR]    [50/80] | Learning Rate: 0.000394
2026-02-26 22:36:29,986 - INFO - [Train] [50/80] | Loss: 0.3501 | Train Acc: 89.36%
2026-02-26 22:36:30,987 - INFO - [Valid] [50/80] | Loss: 0.4621 | Val Acc: 83.78%
2026-02-26 22:36:30,990 - INFO - [Metrics for 'abnormal'] | Precision: 0.8000 | Recall: 0.8662 | F1: 0.8318
2026-02-26 22:36:30,990 - INFO - [Metrics for 'normal'] | Precision: 0.8757 | Recall: 0.8132 | F1: 0.8433
2026-02-26 22:36:30,991 - INFO - --------------------------------------------------
2026-02-26 22:36:30,991 - INFO - [LR]    [51/80] | Learning Rate: 0.000378
2026-02-26 22:36:35,835 - INFO - [Train] [51/80] | Loss: 0.3363 | Train Acc: 91.22%
2026-02-26 22:36:36,922 - INFO - [Valid] [51/80] | Loss: 0.4808 | Val Acc: 85.55%
2026-02-26 22:36:36,926 - INFO - [Metrics for 'abnormal'] | Precision: 0.8176 | Recall: 0.8854 | F1: 0.8502
2026-02-26 22:36:36,933 - INFO - [Metrics for 'normal'] | Precision: 0.8935 | Recall: 0.8297 | F1: 0.8604
2026-02-26 22:36:36,934 - INFO - --------------------------------------------------
2026-02-26 22:36:36,934 - INFO - [LR]    [52/80] | Learning Rate: 0.000362
2026-02-26 22:36:41,360 - INFO - [Train] [52/80] | Loss: 0.3507 | Train Acc: 90.25%
2026-02-26 22:36:42,690 - INFO - [Valid] [52/80] | Loss: 0.4375 | Val Acc: 85.55%
2026-02-26 22:36:42,693 - INFO - [Metrics for 'abnormal'] | Precision: 0.8506 | Recall: 0.8344 | F1: 0.8424
2026-02-26 22:36:42,693 - INFO - [Metrics for 'normal'] | Precision: 0.8595 | Recall: 0.8736 | F1: 0.8665
2026-02-26 22:36:42,702 - INFO - [Best Model Saved] (val loss: 0.4375) -> 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'
2026-02-26 22:36:42,703 - INFO - --------------------------------------------------
2026-02-26 22:36:42,703 - INFO - [LR]    [53/80] | Learning Rate: 0.000346
2026-02-26 22:36:46,945 - INFO - [Train] [53/80] | Loss: 0.3455 | Train Acc: 90.70%
2026-02-26 22:36:48,414 - INFO - [Valid] [53/80] | Loss: 0.4648 | Val Acc: 84.07%
2026-02-26 22:36:48,418 - INFO - [Metrics for 'abnormal'] | Precision: 0.7877 | Recall: 0.8981 | F1: 0.8393
2026-02-26 22:36:48,418 - INFO - [Metrics for 'normal'] | Precision: 0.9000 | Recall: 0.7912 | F1: 0.8421
2026-02-26 22:36:48,418 - INFO - --------------------------------------------------
2026-02-26 22:36:48,418 - INFO - [LR]    [54/80] | Learning Rate: 0.000330
2026-02-26 22:36:52,400 - INFO - [Train] [54/80] | Loss: 0.3356 | Train Acc: 91.15%
2026-02-26 22:36:54,015 - INFO - [Valid] [54/80] | Loss: 0.4553 | Val Acc: 84.66%
2026-02-26 22:36:54,022 - INFO - [Metrics for 'abnormal'] | Precision: 0.8221 | Recall: 0.8535 | F1: 0.8375
2026-02-26 22:36:54,022 - INFO - [Metrics for 'normal'] | Precision: 0.8693 | Recall: 0.8407 | F1: 0.8547
2026-02-26 22:36:54,023 - INFO - --------------------------------------------------
2026-02-26 22:36:54,023 - INFO - [LR]    [55/80] | Learning Rate: 0.000315
2026-02-26 22:36:57,689 - INFO - [Train] [55/80] | Loss: 0.3470 | Train Acc: 90.77%
2026-02-26 22:36:59,467 - INFO - [Valid] [55/80] | Loss: 0.4621 | Val Acc: 84.96%
2026-02-26 22:36:59,478 - INFO - [Metrics for 'abnormal'] | Precision: 0.8354 | Recall: 0.8408 | F1: 0.8381
2026-02-26 22:36:59,479 - INFO - [Metrics for 'normal'] | Precision: 0.8619 | Recall: 0.8571 | F1: 0.8595
2026-02-26 22:36:59,479 - INFO - --------------------------------------------------
2026-02-26 22:36:59,479 - INFO - [LR]    [56/80] | Learning Rate: 0.000300
2026-02-26 22:37:04,180 - INFO - [Train] [56/80] | Loss: 0.3311 | Train Acc: 90.77%
2026-02-26 22:37:05,704 - INFO - [Valid] [56/80] | Loss: 0.4554 | Val Acc: 83.78%
2026-02-26 22:37:05,711 - INFO - [Metrics for 'abnormal'] | Precision: 0.7865 | Recall: 0.8917 | F1: 0.8358
2026-02-26 22:37:05,713 - INFO - [Metrics for 'normal'] | Precision: 0.8944 | Recall: 0.7912 | F1: 0.8397
2026-02-26 22:37:05,713 - INFO - --------------------------------------------------
2026-02-26 22:37:05,713 - INFO - [LR]    [57/80] | Learning Rate: 0.000285
2026-02-26 22:37:10,096 - INFO - [Train] [57/80] | Loss: 0.3439 | Train Acc: 90.33%
2026-02-26 22:37:11,623 - INFO - [Valid] [57/80] | Loss: 0.4522 | Val Acc: 84.37%
2026-02-26 22:37:11,627 - INFO - [Metrics for 'abnormal'] | Precision: 0.8333 | Recall: 0.8280 | F1: 0.8307
2026-02-26 22:37:11,628 - INFO - [Metrics for 'normal'] | Precision: 0.8525 | Recall: 0.8571 | F1: 0.8548
2026-02-26 22:37:11,628 - INFO - --------------------------------------------------
2026-02-26 22:37:11,629 - INFO - [LR]    [58/80] | Learning Rate: 0.000271
2026-02-26 22:37:15,461 - INFO - [Train] [58/80] | Loss: 0.3361 | Train Acc: 90.70%
2026-02-26 22:37:17,013 - INFO - [Valid] [58/80] | Loss: 0.4525 | Val Acc: 83.78%
2026-02-26 22:37:17,018 - INFO - [Metrics for 'abnormal'] | Precision: 0.8400 | Recall: 0.8025 | F1: 0.8208
2026-02-26 22:37:17,019 - INFO - [Metrics for 'normal'] | Precision: 0.8360 | Recall: 0.8681 | F1: 0.8518
2026-02-26 22:37:17,019 - INFO - --------------------------------------------------
2026-02-26 22:37:17,019 - INFO - [LR]    [59/80] | Learning Rate: 0.000258
2026-02-26 22:37:21,291 - INFO - [Train] [59/80] | Loss: 0.3370 | Train Acc: 90.77%
2026-02-26 22:37:22,998 - INFO - [Valid] [59/80] | Loss: 0.4737 | Val Acc: 84.37%
2026-02-26 22:37:23,004 - INFO - [Metrics for 'abnormal'] | Precision: 0.7989 | Recall: 0.8854 | F1: 0.8399
2026-02-26 22:37:23,004 - INFO - [Metrics for 'normal'] | Precision: 0.8909 | Recall: 0.8077 | F1: 0.8473
2026-02-26 22:37:23,004 - INFO - --------------------------------------------------
2026-02-26 22:37:23,004 - INFO - [LR]    [60/80] | Learning Rate: 0.000245
2026-02-26 22:37:27,316 - INFO - [Train] [60/80] | Loss: 0.3286 | Train Acc: 91.74%
2026-02-26 22:37:28,883 - INFO - [Valid] [60/80] | Loss: 0.4701 | Val Acc: 85.55%
2026-02-26 22:37:28,887 - INFO - [Metrics for 'abnormal'] | Precision: 0.8418 | Recall: 0.8471 | F1: 0.8444
2026-02-26 22:37:28,887 - INFO - [Metrics for 'normal'] | Precision: 0.8674 | Recall: 0.8626 | F1: 0.8650
2026-02-26 22:37:28,887 - INFO - --------------------------------------------------
2026-02-26 22:37:28,887 - INFO - [LR]    [61/80] | Learning Rate: 0.000232
2026-02-26 22:37:32,930 - INFO - [Train] [61/80] | Loss: 0.3215 | Train Acc: 91.74%
2026-02-26 22:37:34,388 - INFO - [Valid] [61/80] | Loss: 0.4768 | Val Acc: 85.55%
2026-02-26 22:37:34,396 - INFO - [Metrics for 'abnormal'] | Precision: 0.8253 | Recall: 0.8726 | F1: 0.8483
2026-02-26 22:37:34,400 - INFO - [Metrics for 'normal'] | Precision: 0.8844 | Recall: 0.8407 | F1: 0.8620
2026-02-26 22:37:34,400 - INFO - --------------------------------------------------
2026-02-26 22:37:34,400 - INFO - [LR]    [62/80] | Learning Rate: 0.000220
2026-02-26 22:37:38,582 - INFO - [Train] [62/80] | Loss: 0.3296 | Train Acc: 91.00%
2026-02-26 22:37:39,825 - INFO - [Valid] [62/80] | Loss: 0.4836 | Val Acc: 84.37%
2026-02-26 22:37:39,829 - INFO - [Metrics for 'abnormal'] | Precision: 0.7921 | Recall: 0.8981 | F1: 0.8418
2026-02-26 22:37:39,829 - INFO - [Metrics for 'normal'] | Precision: 0.9006 | Recall: 0.7967 | F1: 0.8455
2026-02-26 22:37:39,829 - INFO - --------------------------------------------------
2026-02-26 22:37:39,829 - INFO - [LR]    [63/80] | Learning Rate: 0.000208
2026-02-26 22:37:44,187 - INFO - [Train] [63/80] | Loss: 0.3274 | Train Acc: 91.89%
2026-02-26 22:37:45,488 - INFO - [Valid] [63/80] | Loss: 0.4822 | Val Acc: 84.66%
2026-02-26 22:37:45,492 - INFO - [Metrics for 'abnormal'] | Precision: 0.8000 | Recall: 0.8917 | F1: 0.8434
2026-02-26 22:37:45,493 - INFO - [Metrics for 'normal'] | Precision: 0.8963 | Recall: 0.8077 | F1: 0.8497
2026-02-26 22:37:45,493 - INFO - --------------------------------------------------
2026-02-26 22:37:45,493 - INFO - [LR]    [64/80] | Learning Rate: 0.000197
2026-02-26 22:37:49,868 - INFO - [Train] [64/80] | Loss: 0.3273 | Train Acc: 91.89%
2026-02-26 22:37:51,217 - INFO - [Valid] [64/80] | Loss: 0.4681 | Val Acc: 85.84%
2026-02-26 22:37:51,228 - INFO - [Metrics for 'abnormal'] | Precision: 0.8303 | Recall: 0.8726 | F1: 0.8509
2026-02-26 22:37:51,228 - INFO - [Metrics for 'normal'] | Precision: 0.8851 | Recall: 0.8462 | F1: 0.8652
2026-02-26 22:37:51,229 - INFO - --------------------------------------------------
2026-02-26 22:37:51,229 - INFO - [LR]    [65/80] | Learning Rate: 0.000186
2026-02-26 22:37:55,456 - INFO - [Train] [65/80] | Loss: 0.3258 | Train Acc: 91.82%
2026-02-26 22:37:56,968 - INFO - [Valid] [65/80] | Loss: 0.4809 | Val Acc: 84.37%
2026-02-26 22:37:56,973 - INFO - [Metrics for 'abnormal'] | Precision: 0.8333 | Recall: 0.8280 | F1: 0.8307
2026-02-26 22:37:56,973 - INFO - [Metrics for 'normal'] | Precision: 0.8525 | Recall: 0.8571 | F1: 0.8548
2026-02-26 22:37:56,973 - INFO - --------------------------------------------------
2026-02-26 22:37:56,973 - INFO - [LR]    [66/80] | Learning Rate: 0.000176
2026-02-26 22:38:01,463 - INFO - [Train] [66/80] | Loss: 0.3207 | Train Acc: 91.52%
2026-02-26 22:38:03,099 - INFO - [Valid] [66/80] | Loss: 0.4668 | Val Acc: 84.66%
2026-02-26 22:38:03,108 - INFO - [Metrics for 'abnormal'] | Precision: 0.8302 | Recall: 0.8408 | F1: 0.8354
2026-02-26 22:38:03,111 - INFO - [Metrics for 'normal'] | Precision: 0.8611 | Recall: 0.8516 | F1: 0.8564
2026-02-26 22:38:03,111 - INFO - --------------------------------------------------
2026-02-26 22:38:03,111 - INFO - [LR]    [67/80] | Learning Rate: 0.000166
2026-02-26 22:38:07,220 - INFO - [Train] [67/80] | Loss: 0.3182 | Train Acc: 91.89%
2026-02-26 22:38:08,689 - INFO - [Valid] [67/80] | Loss: 0.4817 | Val Acc: 84.37%
2026-02-26 22:38:08,694 - INFO - [Metrics for 'abnormal'] | Precision: 0.8095 | Recall: 0.8662 | F1: 0.8369
2026-02-26 22:38:08,694 - INFO - [Metrics for 'normal'] | Precision: 0.8772 | Recall: 0.8242 | F1: 0.8499
2026-02-26 22:38:08,694 - INFO - --------------------------------------------------
2026-02-26 22:38:08,695 - INFO - [LR]    [68/80] | Learning Rate: 0.000157
2026-02-26 22:38:13,180 - INFO - [Train] [68/80] | Loss: 0.3163 | Train Acc: 92.49%
2026-02-26 22:38:14,706 - INFO - [Valid] [68/80] | Loss: 0.4807 | Val Acc: 84.96%
2026-02-26 22:38:14,711 - INFO - [Metrics for 'abnormal'] | Precision: 0.8155 | Recall: 0.8726 | F1: 0.8431
2026-02-26 22:38:14,711 - INFO - [Metrics for 'normal'] | Precision: 0.8830 | Recall: 0.8297 | F1: 0.8555
2026-02-26 22:38:14,711 - INFO - --------------------------------------------------
2026-02-26 22:38:14,711 - INFO - [LR]    [69/80] | Learning Rate: 0.000149
2026-02-26 22:38:19,531 - INFO - [Train] [69/80] | Loss: 0.3294 | Train Acc: 91.96%
2026-02-26 22:38:20,924 - INFO - [Valid] [69/80] | Loss: 0.4661 | Val Acc: 85.84%
2026-02-26 22:38:20,937 - INFO - [Metrics for 'abnormal'] | Precision: 0.8303 | Recall: 0.8726 | F1: 0.8509
2026-02-26 22:38:20,937 - INFO - [Metrics for 'normal'] | Precision: 0.8851 | Recall: 0.8462 | F1: 0.8652
2026-02-26 22:38:20,937 - INFO - --------------------------------------------------
2026-02-26 22:38:20,937 - INFO - [LR]    [70/80] | Learning Rate: 0.000141
2026-02-26 22:38:25,203 - INFO - [Train] [70/80] | Loss: 0.3263 | Train Acc: 91.67%
2026-02-26 22:38:26,582 - INFO - [Valid] [70/80] | Loss: 0.4723 | Val Acc: 84.96%
2026-02-26 22:38:26,597 - INFO - [Metrics for 'abnormal'] | Precision: 0.8272 | Recall: 0.8535 | F1: 0.8401
2026-02-26 22:38:26,597 - INFO - [Metrics for 'normal'] | Precision: 0.8701 | Recall: 0.8462 | F1: 0.8579
2026-02-26 22:38:26,600 - INFO - --------------------------------------------------
2026-02-26 22:38:26,601 - INFO - [LR]    [71/80] | Learning Rate: 0.000134
2026-02-26 22:38:30,831 - INFO - [Train] [71/80] | Loss: 0.3128 | Train Acc: 93.01%
2026-02-26 22:38:32,068 - INFO - [Valid] [71/80] | Loss: 0.4506 | Val Acc: 85.84%
2026-02-26 22:38:32,072 - INFO - [Metrics for 'abnormal'] | Precision: 0.8471 | Recall: 0.8471 | F1: 0.8471
2026-02-26 22:38:32,072 - INFO - [Metrics for 'normal'] | Precision: 0.8681 | Recall: 0.8681 | F1: 0.8681
2026-02-26 22:38:32,072 - INFO - --------------------------------------------------
2026-02-26 22:38:32,072 - INFO - [LR]    [72/80] | Learning Rate: 0.000128
2026-02-26 22:38:36,938 - INFO - [Train] [72/80] | Loss: 0.3148 | Train Acc: 92.26%
2026-02-26 22:38:38,242 - INFO - [Valid] [72/80] | Loss: 0.4671 | Val Acc: 85.55%
2026-02-26 22:38:38,247 - INFO - [Metrics for 'abnormal'] | Precision: 0.8140 | Recall: 0.8917 | F1: 0.8511
2026-02-26 22:38:38,247 - INFO - [Metrics for 'normal'] | Precision: 0.8982 | Recall: 0.8242 | F1: 0.8596
2026-02-26 22:38:38,247 - INFO - --------------------------------------------------
2026-02-26 22:38:38,247 - INFO - [LR]    [73/80] | Learning Rate: 0.000122
2026-02-26 22:38:42,557 - INFO - [Train] [73/80] | Loss: 0.3169 | Train Acc: 91.96%
2026-02-26 22:38:43,647 - INFO - [Valid] [73/80] | Loss: 0.4544 | Val Acc: 85.84%
2026-02-26 22:38:43,655 - INFO - [Metrics for 'abnormal'] | Precision: 0.8344 | Recall: 0.8662 | F1: 0.8500
2026-02-26 22:38:43,658 - INFO - [Metrics for 'normal'] | Precision: 0.8807 | Recall: 0.8516 | F1: 0.8659
2026-02-26 22:38:43,658 - INFO - --------------------------------------------------
2026-02-26 22:38:43,658 - INFO - [LR]    [74/80] | Learning Rate: 0.000117
2026-02-26 22:38:48,119 - INFO - [Train] [74/80] | Loss: 0.3114 | Train Acc: 92.63%
2026-02-26 22:38:49,135 - INFO - [Valid] [74/80] | Loss: 0.4553 | Val Acc: 85.25%
2026-02-26 22:38:49,140 - INFO - [Metrics for 'abnormal'] | Precision: 0.8282 | Recall: 0.8599 | F1: 0.8438
2026-02-26 22:38:49,140 - INFO - [Metrics for 'normal'] | Precision: 0.8750 | Recall: 0.8462 | F1: 0.8603
2026-02-26 22:38:49,140 - INFO - --------------------------------------------------
2026-02-26 22:38:49,140 - INFO - [LR]    [75/80] | Learning Rate: 0.000112
2026-02-26 22:38:53,745 - INFO - [Train] [75/80] | Loss: 0.3173 | Train Acc: 91.74%
2026-02-26 22:38:54,952 - INFO - [Valid] [75/80] | Loss: 0.4473 | Val Acc: 85.84%
2026-02-26 22:38:54,956 - INFO - [Metrics for 'abnormal'] | Precision: 0.8344 | Recall: 0.8662 | F1: 0.8500
2026-02-26 22:38:54,956 - INFO - [Metrics for 'normal'] | Precision: 0.8807 | Recall: 0.8516 | F1: 0.8659
2026-02-26 22:38:54,956 - INFO - --------------------------------------------------
2026-02-26 22:38:54,956 - INFO - [LR]    [76/80] | Learning Rate: 0.000109
2026-02-26 22:38:59,692 - INFO - [Train] [76/80] | Loss: 0.3138 | Train Acc: 91.96%
2026-02-26 22:39:00,799 - INFO - [Valid] [76/80] | Loss: 0.4517 | Val Acc: 86.14%
2026-02-26 22:39:00,802 - INFO - [Metrics for 'abnormal'] | Precision: 0.8571 | Recall: 0.8408 | F1: 0.8489
2026-02-26 22:39:00,802 - INFO - [Metrics for 'normal'] | Precision: 0.8649 | Recall: 0.8791 | F1: 0.8719
2026-02-26 22:39:00,803 - INFO - --------------------------------------------------
2026-02-26 22:39:00,803 - INFO - [LR]    [77/80] | Learning Rate: 0.000106
2026-02-26 22:39:04,871 - INFO - [Train] [77/80] | Loss: 0.3193 | Train Acc: 91.67%
2026-02-26 22:39:05,951 - INFO - [Valid] [77/80] | Loss: 0.4493 | Val Acc: 85.25%
2026-02-26 22:39:05,960 - INFO - [Metrics for 'abnormal'] | Precision: 0.8408 | Recall: 0.8408 | F1: 0.8408
2026-02-26 22:39:05,963 - INFO - [Metrics for 'normal'] | Precision: 0.8626 | Recall: 0.8626 | F1: 0.8626
2026-02-26 22:39:05,963 - INFO - --------------------------------------------------
2026-02-26 22:39:05,963 - INFO - [LR]    [78/80] | Learning Rate: 0.000103
2026-02-26 22:39:09,618 - INFO - [Train] [78/80] | Loss: 0.3117 | Train Acc: 92.34%
2026-02-26 22:39:10,428 - INFO - [Valid] [78/80] | Loss: 0.4524 | Val Acc: 85.55%
2026-02-26 22:39:10,432 - INFO - [Metrics for 'abnormal'] | Precision: 0.8418 | Recall: 0.8471 | F1: 0.8444
2026-02-26 22:39:10,432 - INFO - [Metrics for 'normal'] | Precision: 0.8674 | Recall: 0.8626 | F1: 0.8650
2026-02-26 22:39:10,432 - INFO - --------------------------------------------------
2026-02-26 22:39:10,432 - INFO - [LR]    [79/80] | Learning Rate: 0.000101
2026-02-26 22:39:13,831 - INFO - [Train] [79/80] | Loss: 0.3035 | Train Acc: 93.82%
2026-02-26 22:39:14,759 - INFO - [Valid] [79/80] | Loss: 0.4532 | Val Acc: 85.25%
2026-02-26 22:39:14,762 - INFO - [Metrics for 'abnormal'] | Precision: 0.8282 | Recall: 0.8599 | F1: 0.8438
2026-02-26 22:39:14,762 - INFO - [Metrics for 'normal'] | Precision: 0.8750 | Recall: 0.8462 | F1: 0.8603
2026-02-26 22:39:14,763 - INFO - --------------------------------------------------
2026-02-26 22:39:14,763 - INFO - [LR]    [80/80] | Learning Rate: 0.000100
2026-02-26 22:39:17,344 - INFO - [Train] [80/80] | Loss: 0.3096 | Train Acc: 93.08%
2026-02-26 22:39:18,361 - INFO - [Valid] [80/80] | Loss: 0.4549 | Val Acc: 85.55%
2026-02-26 22:39:18,364 - INFO - [Metrics for 'abnormal'] | Precision: 0.8333 | Recall: 0.8599 | F1: 0.8464
2026-02-26 22:39:18,364 - INFO - [Metrics for 'normal'] | Precision: 0.8757 | Recall: 0.8516 | F1: 0.8635
2026-02-26 22:39:18,365 - INFO - 훈련 완료. 최고 성능 모델 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth'을(를) 불러와 테스트 세트로 최종 평가합니다.
2026-02-26 22:39:18,424 - INFO - ICAM Pruning 정책: full_model (encoder+decoder+classifier 대상, 마지막 분류층/attention qkv/embedding bridge/learnable queries 제외). ignored_layers=23
2026-02-26 22:39:18,425 - INFO - Wanda Pruning을 시작합니다.
2026-02-26 22:39:18,426 - INFO - 저장된 pruning_history가 있어 Wanda calibration을 건너뜁니다.
2026-02-26 22:39:18,426 - INFO - 분류 레이어 'Linear'을(를) Pruning 대상에서 제외합니다.
2026-02-26 22:39:18,490 - INFO - 저장된 pruning_history를 사용해 Pruning 구조를 재현했습니다.
2026-02-26 22:39:18,490 - INFO - torch-pruning 완료. 모델 구조가 희소도(0.7)에 맞춰 변경되었습니다.
2026-02-26 22:39:18,490 - INFO - ==================================================
2026-02-26 22:39:18,521 - INFO - ==================================================
2026-02-26 22:39:18,521 - INFO - Test 모드를 시작합니다.
2026-02-26 22:39:18,554 - INFO - 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/best_model.pth' 가중치 로드 완료.
2026-02-26 22:39:18,555 - INFO - FLOPs 및 MACs 측정을 시작합니다...
2026-02-26 22:39:18,559 - WARNING - FLOPs/MACs 측정 중 오류 발생: Only Tensors created explicitly by the user (graph leaves) support the deepcopy protocol at the moment.  If you were attempting to deepcopy a module, this may be because of a torch.nn.utils.weight_norm usage, see https://github.com/pytorch/pytorch/pull/103001
2026-02-26 22:39:19,498 - INFO - [Test] Loss: 0.3509 | Test Acc: 85.55%
2026-02-26 22:39:19,500 - INFO - [Metrics for 'abnormal'] | Precision: 0.8506 | Recall: 0.8344 | F1: 0.8424
2026-02-26 22:39:19,500 - INFO - [Metrics for 'normal'] | Precision: 0.8595 | Recall: 0.8736 | F1: 0.8665
2026-02-26 22:39:19,644 - INFO - ==================================================
2026-02-26 22:39:19,644 - INFO - 혼동 행렬 저장 완료. 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/confusion_matrix_20260226_223035.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/confusion_matrix_20260226_223035.pdf'
2026-02-26 22:39:19,645 - INFO - 어텐션 맵 시각화를 시작합니다 (339개 샘플, 저장 위치: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/attention_map_20260226_223035').
2026-02-26 23:07:27,000 - INFO - 어텐션 맵 339개 저장 완료.
2026-02-26 23:07:27,100 - INFO - Val Acc 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/val_acc.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/val_acc.pdf'
2026-02-26 23:07:27,212 - INFO - Train/Val Acc 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/train_val_acc.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/train_val_acc.pdf'
2026-02-26 23:07:27,305 - INFO - F1 (normal) 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/F1_normal.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/F1_normal.pdf'
2026-02-26 23:07:27,409 - INFO - Validation Loss 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/val_loss.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/val_loss.pdf'
2026-02-26 23:07:27,505 - INFO - Learning Rate 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/learning_rate.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/learning_rate.pdf'
2026-02-26 23:07:28,442 - INFO - 종합 그래프 저장 완료: 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/compile.png' and 'log/Sewer_TAPNEW/main_20260226_223035_grid7_patch7_layer6_head4/graph_20260226_223035/compile.pdf'
