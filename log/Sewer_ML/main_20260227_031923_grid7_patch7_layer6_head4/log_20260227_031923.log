2026-02-27 03:19:23,525 - INFO - 로그 파일이 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/log_20260227_031923.log'에 저장됩니다.
2026-02-27 03:19:23,525 - INFO - 전역 랜덤 시드를 42로 고정합니다.
2026-02-27 03:19:23,526 - INFO - ==================================================
2026-02-27 03:19:23,526 - INFO - config.yaml:
2026-02-27 03:19:23,526 - INFO - 
run:
  global_seed: 42
  cuda: true
  mode: train
  pth_best_name: best_model.pth
  only_inference: false
  show_log: true
  dataset:
    name: Sewer_ML
    type: csv
    train_split_ratio: 0.8
    paths:
      train_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/train
      valid_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      test_img_dir: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/valid
      train_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Train.csv
      valid_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      test_csv: /home/tai/workspace/ssd1/data/Sewer/Sewer-ML/SewerML_Val.csv
      img_folder: /home/tai/workspace/ssd1/data/Sewer/Sewer-TAPNEW
  random_sampling_ratio:
    train: 1.0
    valid: 1.0
    test: 1.0
  num_workers: 16
model:
  img_size: 224
  num_patches_per_side: 7
  num_decoder_patches: 7
  num_decoder_layers: 6
  num_heads: 4
  cnn_feature_extractor:
    name: custom32
  encoder_dim: 32
  emb_dim: 32
  adaptive_initial_query: true
  decoder_ff_ratio: 2
  dropout: 0.1
  positional_encoding: true
  drop_path_ratio: 0.2
  visualize_attention: true
  num_plot_attention: 1500
training_main:
  epochs: 90
  batch_size: 256
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 90
    eta_min: 0.0001
  best_model_criterion: val_loss
training_baseline:
  model_name: mobilenet_v4_s
  epochs: 10
  batch_size: 16
  pre_trained: false
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 10
    eta_min: 0.0001
  best_model_criterion: val_loss
finetuning_pruned:
  epochs: 80
  batch_size: 16
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.0001
  loss_function: CrossEntropyLoss
  label_smoothing: 0.1
  scheduler: cosineannealinglr
  scheduler_params:
    T_max: 80
    eta_min: 0.0001
  best_model_criterion: val_loss
  exclude_attention_qkv_pruning: true
  exclude_embedding_bridge_pruning: true
  exclude_learnable_queries_pruning: true

2026-02-27 03:19:23,526 - INFO - ==================================================
2026-02-27 03:19:23,666 - INFO - CUDA 사용 가능. GPU 사용을 시작합니다. (Device: NVIDIA GeForce RTX 5090)
2026-02-27 03:19:23,666 - INFO - 'Sewer_ML' 데이터 로드를 시작합니다 (Type: csv).
2026-02-27 03:19:24,230 - INFO - 데이터셋 클래스: ['Normal', 'Defect'] (총 2개)
2026-02-27 03:19:24,230 - INFO - 훈련 데이터: 1040129개, 검증 데이터: 130046개, 테스트 데이터: 130046개
2026-02-27 03:19:24,230 - INFO - 이미지 크기: 224, 그리드 크기: 7x7 -> 인코더 패치 수: 49개
2026-02-27 03:19:24,302 - INFO - ==================================================
2026-02-27 03:19:24,302 - INFO - 모델 파라미터 수: 91,138 개
2026-02-27 03:19:24,302 - INFO -   - Encoder (Encoder):         22,656 개
2026-02-27 03:19:24,302 - INFO -     - conv_front (CNN Backbone):        22,592 개
2026-02-27 03:19:24,302 - INFO -     - 1x1_conv (Channel Proj):          0 개
2026-02-27 03:19:24,302 - INFO -     - norm (LayerNorm):                 64 개
2026-02-27 03:19:24,302 - INFO -   - Decoder (Cross-Attention-based):    53,504 개
2026-02-27 03:19:24,302 - INFO -     - Embedding Layer (feat_to_emb):   1,056 개
2026-02-27 03:19:24,302 - INFO -     - Init Key Proj (W_K_init):         1,056 개
2026-02-27 03:19:24,302 - INFO -     - Init Value Proj (W_V_init):       1,056 개
2026-02-27 03:19:24,302 - INFO -     - Learnable Queries:                224 개
2026-02-27 03:19:24,302 - INFO -     - Decoder Layers:                   50,112 개
2026-02-27 03:19:24,302 - INFO -   - Classifier (Projection MLP):        14,978 개
2026-02-27 03:19:24,302 - INFO - ================================================================================
2026-02-27 03:19:24,302 - INFO - 단계 1/2: training_main 기반 사전 훈련(Pre-training)을 시작합니다.
2026-02-27 03:19:24,302 - INFO - ================================================================================
2026-02-27 03:19:24,302 - INFO - 옵티마이저: AdamW (lr=0.001, weight_decay=0.0001)
2026-02-27 03:19:24,302 - INFO - 스케줄러: CosineAnnealingLR (T_max=90, eta_min=0.0001)
2026-02-27 03:19:24,302 - INFO - ==================================================
2026-02-27 03:19:24,302 - INFO - train 모드를 시작합니다.
2026-02-27 03:19:24,302 - INFO - 손실 함수: CrossEntropyLoss (label_smoothing: 0.1)
2026-02-27 03:19:24,302 - INFO - --------------------------------------------------
2026-02-27 03:19:24,302 - INFO - [LR]    [1/90] | Learning Rate: 0.001000
2026-02-27 03:26:49,618 - INFO - [Train] [1/90] | Loss: 0.4469 | Train Acc: 83.95%
2026-02-27 03:27:28,495 - INFO - [Valid] [1/90] | Loss: 0.4157 | Val Acc: 86.42%
2026-02-27 03:27:28,623 - INFO - [Metrics for 'Normal'] | Precision: 0.8801 | Recall: 0.8601 | F1: 0.8700
2026-02-27 03:27:28,623 - INFO - [Metrics for 'Defect'] | Precision: 0.8473 | Recall: 0.8689 | F1: 0.8580
2026-02-27 03:27:28,629 - INFO - [Best Model Saved] (val loss: 0.4157) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 03:27:28,629 - INFO - --------------------------------------------------
2026-02-27 03:27:28,629 - INFO - [LR]    [2/90] | Learning Rate: 0.001000
2026-02-27 03:34:53,185 - INFO - [Train] [2/90] | Loss: 0.4121 | Train Acc: 86.51%
2026-02-27 03:35:32,368 - INFO - [Valid] [2/90] | Loss: 0.4007 | Val Acc: 87.18%
2026-02-27 03:35:32,509 - INFO - [Metrics for 'Normal'] | Precision: 0.9096 | Recall: 0.8408 | F1: 0.8739
2026-02-27 03:35:32,509 - INFO - [Metrics for 'Defect'] | Precision: 0.8357 | Recall: 0.9065 | F1: 0.8697
2026-02-27 03:35:32,515 - INFO - [Best Model Saved] (val loss: 0.4007) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 03:35:32,515 - INFO - --------------------------------------------------
2026-02-27 03:35:32,515 - INFO - [LR]    [3/90] | Learning Rate: 0.000999
2026-02-27 03:42:57,231 - INFO - [Train] [3/90] | Loss: 0.3997 | Train Acc: 87.42%
2026-02-27 03:43:36,161 - INFO - [Valid] [3/90] | Loss: 0.3911 | Val Acc: 88.18%
2026-02-27 03:43:36,325 - INFO - [Metrics for 'Normal'] | Precision: 0.9126 | Recall: 0.8584 | F1: 0.8847
2026-02-27 03:43:36,325 - INFO - [Metrics for 'Defect'] | Precision: 0.8514 | Recall: 0.9080 | F1: 0.8788
2026-02-27 03:43:36,333 - INFO - [Best Model Saved] (val loss: 0.3911) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 03:43:36,333 - INFO - --------------------------------------------------
2026-02-27 03:43:36,333 - INFO - [LR]    [4/90] | Learning Rate: 0.000998
2026-02-27 03:51:00,942 - INFO - [Train] [4/90] | Loss: 0.3910 | Train Acc: 87.99%
2026-02-27 03:51:39,977 - INFO - [Valid] [4/90] | Loss: 0.3786 | Val Acc: 88.79%
2026-02-27 03:51:40,137 - INFO - [Metrics for 'Normal'] | Precision: 0.8873 | Recall: 0.9025 | F1: 0.8948
2026-02-27 03:51:40,137 - INFO - [Metrics for 'Defect'] | Precision: 0.8887 | Recall: 0.8717 | F1: 0.8801
2026-02-27 03:51:40,145 - INFO - [Best Model Saved] (val loss: 0.3786) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 03:51:40,145 - INFO - --------------------------------------------------
2026-02-27 03:51:40,145 - INFO - [LR]    [5/90] | Learning Rate: 0.000996
2026-02-27 03:59:05,199 - INFO - [Train] [5/90] | Loss: 0.3849 | Train Acc: 88.42%
2026-02-27 03:59:44,843 - INFO - [Valid] [5/90] | Loss: 0.3769 | Val Acc: 88.95%
2026-02-27 03:59:45,016 - INFO - [Metrics for 'Normal'] | Precision: 0.8999 | Recall: 0.8897 | F1: 0.8948
2026-02-27 03:59:45,016 - INFO - [Metrics for 'Defect'] | Precision: 0.8781 | Recall: 0.8892 | F1: 0.8836
2026-02-27 03:59:45,024 - INFO - [Best Model Saved] (val loss: 0.3769) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 03:59:45,024 - INFO - --------------------------------------------------
2026-02-27 03:59:45,024 - INFO - [LR]    [6/90] | Learning Rate: 0.000993
2026-02-27 04:07:11,897 - INFO - [Train] [6/90] | Loss: 0.3799 | Train Acc: 88.78%
2026-02-27 04:07:50,742 - INFO - [Valid] [6/90] | Loss: 0.3711 | Val Acc: 89.30%
2026-02-27 04:07:50,884 - INFO - [Metrics for 'Normal'] | Precision: 0.9061 | Recall: 0.8896 | F1: 0.8978
2026-02-27 04:07:50,884 - INFO - [Metrics for 'Defect'] | Precision: 0.8789 | Recall: 0.8969 | F1: 0.8878
2026-02-27 04:07:50,890 - INFO - [Best Model Saved] (val loss: 0.3711) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:07:50,890 - INFO - --------------------------------------------------
2026-02-27 04:07:50,890 - INFO - [LR]    [7/90] | Learning Rate: 0.000990
2026-02-27 04:15:17,720 - INFO - [Train] [7/90] | Loss: 0.3760 | Train Acc: 89.04%
2026-02-27 04:15:56,329 - INFO - [Valid] [7/90] | Loss: 0.3676 | Val Acc: 89.63%
2026-02-27 04:15:56,502 - INFO - [Metrics for 'Normal'] | Precision: 0.9143 | Recall: 0.8868 | F1: 0.9004
2026-02-27 04:15:56,502 - INFO - [Metrics for 'Defect'] | Precision: 0.8775 | Recall: 0.9070 | F1: 0.8920
2026-02-27 04:15:56,510 - INFO - [Best Model Saved] (val loss: 0.3676) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:15:56,510 - INFO - --------------------------------------------------
2026-02-27 04:15:56,510 - INFO - [LR]    [8/90] | Learning Rate: 0.000987
2026-02-27 04:23:23,340 - INFO - [Train] [8/90] | Loss: 0.3727 | Train Acc: 89.26%
2026-02-27 04:24:02,607 - INFO - [Valid] [8/90] | Loss: 0.3636 | Val Acc: 89.88%
2026-02-27 04:24:02,780 - INFO - [Metrics for 'Normal'] | Precision: 0.9219 | Recall: 0.8833 | F1: 0.9022
2026-02-27 04:24:02,780 - INFO - [Metrics for 'Defect'] | Precision: 0.8752 | Recall: 0.9162 | F1: 0.8953
2026-02-27 04:24:02,787 - INFO - [Best Model Saved] (val loss: 0.3636) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:24:02,788 - INFO - --------------------------------------------------
2026-02-27 04:24:02,788 - INFO - [LR]    [9/90] | Learning Rate: 0.000983
2026-02-27 04:31:29,812 - INFO - [Train] [9/90] | Loss: 0.3697 | Train Acc: 89.47%
2026-02-27 04:32:09,098 - INFO - [Valid] [9/90] | Loss: 0.3615 | Val Acc: 89.94%
2026-02-27 04:32:09,241 - INFO - [Metrics for 'Normal'] | Precision: 0.9229 | Recall: 0.8832 | F1: 0.9026
2026-02-27 04:32:09,241 - INFO - [Metrics for 'Defect'] | Precision: 0.8753 | Recall: 0.9174 | F1: 0.8959
2026-02-27 04:32:09,246 - INFO - [Best Model Saved] (val loss: 0.3615) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:32:09,247 - INFO - --------------------------------------------------
2026-02-27 04:32:09,247 - INFO - [LR]    [10/90] | Learning Rate: 0.000978
2026-02-27 04:39:39,994 - INFO - [Train] [10/90] | Loss: 0.3672 | Train Acc: 89.61%
2026-02-27 04:40:19,017 - INFO - [Valid] [10/90] | Loss: 0.3595 | Val Acc: 90.10%
2026-02-27 04:40:19,159 - INFO - [Metrics for 'Normal'] | Precision: 0.9125 | Recall: 0.8987 | F1: 0.9055
2026-02-27 04:40:19,159 - INFO - [Metrics for 'Defect'] | Precision: 0.8885 | Recall: 0.9035 | F1: 0.8959
2026-02-27 04:40:19,165 - INFO - [Best Model Saved] (val loss: 0.3595) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:40:19,165 - INFO - --------------------------------------------------
2026-02-27 04:40:19,165 - INFO - [LR]    [11/90] | Learning Rate: 0.000973
2026-02-27 04:47:46,733 - INFO - [Train] [11/90] | Loss: 0.3649 | Train Acc: 89.78%
2026-02-27 04:48:25,702 - INFO - [Valid] [11/90] | Loss: 0.3581 | Val Acc: 90.05%
2026-02-27 04:48:25,867 - INFO - [Metrics for 'Normal'] | Precision: 0.9218 | Recall: 0.8868 | F1: 0.9039
2026-02-27 04:48:25,867 - INFO - [Metrics for 'Defect'] | Precision: 0.8785 | Recall: 0.9158 | F1: 0.8967
2026-02-27 04:48:25,875 - INFO - [Best Model Saved] (val loss: 0.3581) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:48:25,875 - INFO - --------------------------------------------------
2026-02-27 04:48:25,875 - INFO - [LR]    [12/90] | Learning Rate: 0.000967
2026-02-27 04:55:53,290 - INFO - [Train] [12/90] | Loss: 0.3633 | Train Acc: 89.87%
2026-02-27 04:56:32,522 - INFO - [Valid] [12/90] | Loss: 0.3571 | Val Acc: 90.19%
2026-02-27 04:56:32,688 - INFO - [Metrics for 'Normal'] | Precision: 0.9040 | Recall: 0.9109 | F1: 0.9074
2026-02-27 04:56:32,688 - INFO - [Metrics for 'Defect'] | Precision: 0.8994 | Recall: 0.8917 | F1: 0.8956
2026-02-27 04:56:32,696 - INFO - [Best Model Saved] (val loss: 0.3571) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 04:56:32,696 - INFO - --------------------------------------------------
2026-02-27 04:56:32,696 - INFO - [LR]    [13/90] | Learning Rate: 0.000961
2026-02-27 05:04:00,362 - INFO - [Train] [13/90] | Loss: 0.3610 | Train Acc: 90.02%
2026-02-27 05:04:39,347 - INFO - [Valid] [13/90] | Loss: 0.3568 | Val Acc: 90.21%
2026-02-27 05:04:39,491 - INFO - [Metrics for 'Normal'] | Precision: 0.9242 | Recall: 0.8874 | F1: 0.9055
2026-02-27 05:04:39,491 - INFO - [Metrics for 'Defect'] | Precision: 0.8794 | Recall: 0.9186 | F1: 0.8985
2026-02-27 05:04:39,497 - INFO - [Best Model Saved] (val loss: 0.3568) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 05:04:39,497 - INFO - --------------------------------------------------
2026-02-27 05:04:39,497 - INFO - [LR]    [14/90] | Learning Rate: 0.000954
2026-02-27 05:12:06,262 - INFO - [Train] [14/90] | Loss: 0.3595 | Train Acc: 90.14%
2026-02-27 05:12:45,069 - INFO - [Valid] [14/90] | Loss: 0.3546 | Val Acc: 90.35%
2026-02-27 05:12:45,243 - INFO - [Metrics for 'Normal'] | Precision: 0.9060 | Recall: 0.9119 | F1: 0.9089
2026-02-27 05:12:45,243 - INFO - [Metrics for 'Defect'] | Precision: 0.9007 | Recall: 0.8941 | F1: 0.8974
2026-02-27 05:12:45,251 - INFO - [Best Model Saved] (val loss: 0.3546) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 05:12:45,251 - INFO - --------------------------------------------------
2026-02-27 05:12:45,251 - INFO - [LR]    [15/90] | Learning Rate: 0.000947
2026-02-27 05:20:12,281 - INFO - [Train] [15/90] | Loss: 0.3583 | Train Acc: 90.20%
2026-02-27 05:20:51,422 - INFO - [Valid] [15/90] | Loss: 0.3542 | Val Acc: 90.51%
2026-02-27 05:20:51,566 - INFO - [Metrics for 'Normal'] | Precision: 0.9271 | Recall: 0.8904 | F1: 0.9084
2026-02-27 05:20:51,566 - INFO - [Metrics for 'Defect'] | Precision: 0.8825 | Recall: 0.9216 | F1: 0.9017
2026-02-27 05:20:51,572 - INFO - [Best Model Saved] (val loss: 0.3542) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 05:20:51,572 - INFO - --------------------------------------------------
2026-02-27 05:20:51,572 - INFO - [LR]    [16/90] | Learning Rate: 0.000940
2026-02-27 05:28:19,687 - INFO - [Train] [16/90] | Loss: 0.3569 | Train Acc: 90.29%
2026-02-27 05:28:58,416 - INFO - [Valid] [16/90] | Loss: 0.3631 | Val Acc: 90.13%
2026-02-27 05:28:58,589 - INFO - [Metrics for 'Normal'] | Precision: 0.9341 | Recall: 0.8748 | F1: 0.9035
2026-02-27 05:28:58,589 - INFO - [Metrics for 'Defect'] | Precision: 0.8692 | Recall: 0.9310 | F1: 0.8990
2026-02-27 05:28:58,592 - INFO - --------------------------------------------------
2026-02-27 05:28:58,592 - INFO - [LR]    [17/90] | Learning Rate: 0.000932
2026-02-27 05:36:25,209 - INFO - [Train] [17/90] | Loss: 0.3554 | Train Acc: 90.38%
2026-02-27 05:37:04,399 - INFO - [Valid] [17/90] | Loss: 0.3523 | Val Acc: 90.74%
2026-02-27 05:37:04,545 - INFO - [Metrics for 'Normal'] | Precision: 0.9194 | Recall: 0.9040 | F1: 0.9116
2026-02-27 05:37:04,545 - INFO - [Metrics for 'Defect'] | Precision: 0.8945 | Recall: 0.9113 | F1: 0.9028
2026-02-27 05:37:04,550 - INFO - [Best Model Saved] (val loss: 0.3523) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 05:37:04,551 - INFO - --------------------------------------------------
2026-02-27 05:37:04,551 - INFO - [LR]    [18/90] | Learning Rate: 0.000923
2026-02-27 05:44:31,698 - INFO - [Train] [18/90] | Loss: 0.3545 | Train Acc: 90.46%
2026-02-27 05:45:10,426 - INFO - [Valid] [18/90] | Loss: 0.3561 | Val Acc: 90.35%
2026-02-27 05:45:10,603 - INFO - [Metrics for 'Normal'] | Precision: 0.9385 | Recall: 0.8747 | F1: 0.9055
2026-02-27 05:45:10,603 - INFO - [Metrics for 'Defect'] | Precision: 0.8696 | Recall: 0.9359 | F1: 0.9016
2026-02-27 05:45:10,606 - INFO - --------------------------------------------------
2026-02-27 05:45:10,606 - INFO - [LR]    [19/90] | Learning Rate: 0.000914
2026-02-27 05:52:38,268 - INFO - [Train] [19/90] | Loss: 0.3530 | Train Acc: 90.55%
2026-02-27 05:53:17,470 - INFO - [Valid] [19/90] | Loss: 0.3592 | Val Acc: 90.18%
2026-02-27 05:53:17,604 - INFO - [Metrics for 'Normal'] | Precision: 0.9408 | Recall: 0.8687 | F1: 0.9034
2026-02-27 05:53:17,604 - INFO - [Metrics for 'Defect'] | Precision: 0.8647 | Recall: 0.9389 | F1: 0.9003
2026-02-27 05:53:17,606 - INFO - --------------------------------------------------
2026-02-27 05:53:17,606 - INFO - [LR]    [20/90] | Learning Rate: 0.000905
2026-02-27 06:00:46,261 - INFO - [Train] [20/90] | Loss: 0.3519 | Train Acc: 90.63%
2026-02-27 06:01:24,906 - INFO - [Valid] [20/90] | Loss: 0.3511 | Val Acc: 90.66%
2026-02-27 06:01:25,051 - INFO - [Metrics for 'Normal'] | Precision: 0.9315 | Recall: 0.8885 | F1: 0.9095
2026-02-27 06:01:25,051 - INFO - [Metrics for 'Defect'] | Precision: 0.8813 | Recall: 0.9268 | F1: 0.9035
2026-02-27 06:01:25,057 - INFO - [Best Model Saved] (val loss: 0.3511) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 06:01:25,057 - INFO - --------------------------------------------------
2026-02-27 06:01:25,057 - INFO - [LR]    [21/90] | Learning Rate: 0.000895
2026-02-27 06:08:52,747 - INFO - [Train] [21/90] | Loss: 0.3511 | Train Acc: 90.66%
2026-02-27 06:09:31,869 - INFO - [Valid] [21/90] | Loss: 0.3477 | Val Acc: 91.07%
2026-02-27 06:09:32,040 - INFO - [Metrics for 'Normal'] | Precision: 0.9215 | Recall: 0.9084 | F1: 0.9149
2026-02-27 06:09:32,040 - INFO - [Metrics for 'Defect'] | Precision: 0.8990 | Recall: 0.9134 | F1: 0.9062
2026-02-27 06:09:32,046 - INFO - [Best Model Saved] (val loss: 0.3477) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 06:09:32,046 - INFO - --------------------------------------------------
2026-02-27 06:09:32,046 - INFO - [LR]    [22/90] | Learning Rate: 0.000884
2026-02-27 06:17:00,705 - INFO - [Train] [22/90] | Loss: 0.3504 | Train Acc: 90.74%
2026-02-27 06:17:40,077 - INFO - [Valid] [22/90] | Loss: 0.3494 | Val Acc: 90.81%
2026-02-27 06:17:40,256 - INFO - [Metrics for 'Normal'] | Precision: 0.9075 | Recall: 0.9198 | F1: 0.9136
2026-02-27 06:17:40,256 - INFO - [Metrics for 'Defect'] | Precision: 0.9088 | Recall: 0.8951 | F1: 0.9019
2026-02-27 06:17:40,258 - INFO - --------------------------------------------------
2026-02-27 06:17:40,258 - INFO - [LR]    [23/90] | Learning Rate: 0.000874
2026-02-27 06:25:08,634 - INFO - [Train] [23/90] | Loss: 0.3491 | Train Acc: 90.80%
2026-02-27 06:25:48,024 - INFO - [Valid] [23/90] | Loss: 0.3515 | Val Acc: 90.62%
2026-02-27 06:25:48,169 - INFO - [Metrics for 'Normal'] | Precision: 0.9186 | Recall: 0.9023 | F1: 0.9104
2026-02-27 06:25:48,169 - INFO - [Metrics for 'Defect'] | Precision: 0.8928 | Recall: 0.9106 | F1: 0.9016
2026-02-27 06:25:48,171 - INFO - --------------------------------------------------
2026-02-27 06:25:48,171 - INFO - [LR]    [24/90] | Learning Rate: 0.000863
2026-02-27 06:33:16,204 - INFO - [Train] [24/90] | Loss: 0.3483 | Train Acc: 90.83%
2026-02-27 06:33:55,115 - INFO - [Valid] [24/90] | Loss: 0.3461 | Val Acc: 90.92%
2026-02-27 06:33:55,260 - INFO - [Metrics for 'Normal'] | Precision: 0.9284 | Recall: 0.8972 | F1: 0.9125
2026-02-27 06:33:55,260 - INFO - [Metrics for 'Defect'] | Precision: 0.8891 | Recall: 0.9226 | F1: 0.9055
2026-02-27 06:33:55,266 - INFO - [Best Model Saved] (val loss: 0.3461) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 06:33:55,266 - INFO - --------------------------------------------------
2026-02-27 06:33:55,266 - INFO - [LR]    [25/90] | Learning Rate: 0.000851
2026-02-27 06:41:22,528 - INFO - [Train] [25/90] | Loss: 0.3474 | Train Acc: 90.89%
2026-02-27 06:42:01,969 - INFO - [Valid] [25/90] | Loss: 0.3464 | Val Acc: 91.01%
2026-02-27 06:42:02,114 - INFO - [Metrics for 'Normal'] | Precision: 0.9294 | Recall: 0.8981 | F1: 0.9135
2026-02-27 06:42:02,114 - INFO - [Metrics for 'Defect'] | Precision: 0.8901 | Recall: 0.9236 | F1: 0.9065
2026-02-27 06:42:02,115 - INFO - --------------------------------------------------
2026-02-27 06:42:02,115 - INFO - [LR]    [26/90] | Learning Rate: 0.000839
2026-02-27 06:49:29,671 - INFO - [Train] [26/90] | Loss: 0.3469 | Train Acc: 90.96%
2026-02-27 06:50:09,280 - INFO - [Valid] [26/90] | Loss: 0.3452 | Val Acc: 91.14%
2026-02-27 06:50:09,425 - INFO - [Metrics for 'Normal'] | Precision: 0.9179 | Recall: 0.9140 | F1: 0.9159
2026-02-27 06:50:09,425 - INFO - [Metrics for 'Defect'] | Precision: 0.9042 | Recall: 0.9085 | F1: 0.9063
2026-02-27 06:50:09,431 - INFO - [Best Model Saved] (val loss: 0.3452) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 06:50:09,431 - INFO - --------------------------------------------------
2026-02-27 06:50:09,431 - INFO - [LR]    [27/90] | Learning Rate: 0.000827
2026-02-27 06:57:37,615 - INFO - [Train] [27/90] | Loss: 0.3459 | Train Acc: 91.01%
2026-02-27 06:58:16,893 - INFO - [Valid] [27/90] | Loss: 0.3490 | Val Acc: 90.88%
2026-02-27 06:58:17,026 - INFO - [Metrics for 'Normal'] | Precision: 0.9412 | Recall: 0.8825 | F1: 0.9109
2026-02-27 06:58:17,026 - INFO - [Metrics for 'Defect'] | Precision: 0.8771 | Recall: 0.9383 | F1: 0.9067
2026-02-27 06:58:17,028 - INFO - --------------------------------------------------
2026-02-27 06:58:17,028 - INFO - [LR]    [28/90] | Learning Rate: 0.000815
2026-02-27 07:05:45,190 - INFO - [Train] [28/90] | Loss: 0.3454 | Train Acc: 91.06%
2026-02-27 07:06:23,890 - INFO - [Valid] [28/90] | Loss: 0.3448 | Val Acc: 91.08%
2026-02-27 07:06:24,036 - INFO - [Metrics for 'Normal'] | Precision: 0.9278 | Recall: 0.9013 | F1: 0.9143
2026-02-27 07:06:24,036 - INFO - [Metrics for 'Defect'] | Precision: 0.8929 | Recall: 0.9215 | F1: 0.9070
2026-02-27 07:06:24,042 - INFO - [Best Model Saved] (val loss: 0.3448) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 07:06:24,042 - INFO - --------------------------------------------------
2026-02-27 07:06:24,042 - INFO - [LR]    [29/90] | Learning Rate: 0.000802
2026-02-27 07:13:52,029 - INFO - [Train] [29/90] | Loss: 0.3447 | Train Acc: 91.10%
2026-02-27 07:14:31,634 - INFO - [Valid] [29/90] | Loss: 0.3466 | Val Acc: 90.95%
2026-02-27 07:14:31,814 - INFO - [Metrics for 'Normal'] | Precision: 0.9339 | Recall: 0.8918 | F1: 0.9124
2026-02-27 07:14:31,814 - INFO - [Metrics for 'Defect'] | Precision: 0.8848 | Recall: 0.9293 | F1: 0.9065
2026-02-27 07:14:31,817 - INFO - --------------------------------------------------
2026-02-27 07:14:31,817 - INFO - [LR]    [30/90] | Learning Rate: 0.000788
2026-02-27 07:21:59,008 - INFO - [Train] [30/90] | Loss: 0.3442 | Train Acc: 91.12%
2026-02-27 07:22:38,458 - INFO - [Valid] [30/90] | Loss: 0.3462 | Val Acc: 91.10%
2026-02-27 07:22:38,602 - INFO - [Metrics for 'Normal'] | Precision: 0.9362 | Recall: 0.8923 | F1: 0.9138
2026-02-27 07:22:38,602 - INFO - [Metrics for 'Defect'] | Precision: 0.8855 | Recall: 0.9320 | F1: 0.9082
2026-02-27 07:22:38,604 - INFO - --------------------------------------------------
2026-02-27 07:22:38,604 - INFO - [LR]    [31/90] | Learning Rate: 0.000775
2026-02-27 07:30:07,389 - INFO - [Train] [31/90] | Loss: 0.3434 | Train Acc: 91.18%
2026-02-27 07:30:46,543 - INFO - [Valid] [31/90] | Loss: 0.3457 | Val Acc: 91.18%
2026-02-27 07:30:46,688 - INFO - [Metrics for 'Normal'] | Precision: 0.9251 | Recall: 0.9065 | F1: 0.9157
2026-02-27 07:30:46,688 - INFO - [Metrics for 'Defect'] | Precision: 0.8976 | Recall: 0.9178 | F1: 0.9076
2026-02-27 07:30:46,690 - INFO - --------------------------------------------------
2026-02-27 07:30:46,690 - INFO - [LR]    [32/90] | Learning Rate: 0.000761
2026-02-27 07:38:15,801 - INFO - [Train] [32/90] | Loss: 0.3428 | Train Acc: 91.24%
2026-02-27 07:38:55,582 - INFO - [Valid] [32/90] | Loss: 0.3429 | Val Acc: 91.26%
2026-02-27 07:38:55,759 - INFO - [Metrics for 'Normal'] | Precision: 0.9279 | Recall: 0.9048 | F1: 0.9162
2026-02-27 07:38:55,759 - INFO - [Metrics for 'Defect'] | Precision: 0.8964 | Recall: 0.9213 | F1: 0.9087
2026-02-27 07:38:55,767 - INFO - [Best Model Saved] (val loss: 0.3429) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 07:38:55,768 - INFO - --------------------------------------------------
2026-02-27 07:38:55,768 - INFO - [LR]    [33/90] | Learning Rate: 0.000747
2026-02-27 07:46:24,308 - INFO - [Train] [33/90] | Loss: 0.3422 | Train Acc: 91.27%
2026-02-27 07:47:03,993 - INFO - [Valid] [33/90] | Loss: 0.3441 | Val Acc: 91.29%
2026-02-27 07:47:04,140 - INFO - [Metrics for 'Normal'] | Precision: 0.9327 | Recall: 0.9000 | F1: 0.9160
2026-02-27 07:47:04,140 - INFO - [Metrics for 'Defect'] | Precision: 0.8923 | Recall: 0.9273 | F1: 0.9094
2026-02-27 07:47:04,141 - INFO - --------------------------------------------------
2026-02-27 07:47:04,141 - INFO - [LR]    [34/90] | Learning Rate: 0.000733
2026-02-27 07:54:32,671 - INFO - [Train] [34/90] | Loss: 0.3414 | Train Acc: 91.29%
2026-02-27 07:55:12,013 - INFO - [Valid] [34/90] | Loss: 0.3416 | Val Acc: 91.34%
2026-02-27 07:55:12,189 - INFO - [Metrics for 'Normal'] | Precision: 0.9323 | Recall: 0.9016 | F1: 0.9167
2026-02-27 07:55:12,190 - INFO - [Metrics for 'Defect'] | Precision: 0.8937 | Recall: 0.9267 | F1: 0.9099
2026-02-27 07:55:12,198 - INFO - [Best Model Saved] (val loss: 0.3416) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 07:55:12,199 - INFO - --------------------------------------------------
2026-02-27 07:55:12,199 - INFO - [LR]    [35/90] | Learning Rate: 0.000719
2026-02-27 08:02:41,255 - INFO - [Train] [35/90] | Loss: 0.3412 | Train Acc: 91.32%
2026-02-27 08:03:20,528 - INFO - [Valid] [35/90] | Loss: 0.3442 | Val Acc: 91.25%
2026-02-27 08:03:20,683 - INFO - [Metrics for 'Normal'] | Precision: 0.9342 | Recall: 0.8975 | F1: 0.9155
2026-02-27 08:03:20,684 - INFO - [Metrics for 'Defect'] | Precision: 0.8901 | Recall: 0.9292 | F1: 0.9092
2026-02-27 08:03:20,686 - INFO - --------------------------------------------------
2026-02-27 08:03:20,686 - INFO - [LR]    [36/90] | Learning Rate: 0.000704
2026-02-27 08:10:49,505 - INFO - [Train] [36/90] | Loss: 0.3404 | Train Acc: 91.36%
2026-02-27 08:11:29,308 - INFO - [Valid] [36/90] | Loss: 0.3417 | Val Acc: 91.37%
2026-02-27 08:11:29,453 - INFO - [Metrics for 'Normal'] | Precision: 0.9218 | Recall: 0.9141 | F1: 0.9179
2026-02-27 08:11:29,453 - INFO - [Metrics for 'Defect'] | Precision: 0.9048 | Recall: 0.9132 | F1: 0.9090
2026-02-27 08:11:29,455 - INFO - --------------------------------------------------
2026-02-27 08:11:29,455 - INFO - [LR]    [37/90] | Learning Rate: 0.000689
2026-02-27 08:18:57,611 - INFO - [Train] [37/90] | Loss: 0.3401 | Train Acc: 91.39%
2026-02-27 08:19:36,860 - INFO - [Valid] [37/90] | Loss: 0.3420 | Val Acc: 91.24%
2026-02-27 08:19:36,994 - INFO - [Metrics for 'Normal'] | Precision: 0.9331 | Recall: 0.8985 | F1: 0.9155
2026-02-27 08:19:36,994 - INFO - [Metrics for 'Defect'] | Precision: 0.8910 | Recall: 0.9279 | F1: 0.9091
2026-02-27 08:19:36,996 - INFO - --------------------------------------------------
2026-02-27 08:19:36,996 - INFO - [LR]    [38/90] | Learning Rate: 0.000674
2026-02-27 08:27:05,572 - INFO - [Train] [38/90] | Loss: 0.3397 | Train Acc: 91.41%
2026-02-27 08:27:44,997 - INFO - [Valid] [38/90] | Loss: 0.3428 | Val Acc: 91.41%
2026-02-27 08:27:45,167 - INFO - [Metrics for 'Normal'] | Precision: 0.9295 | Recall: 0.9061 | F1: 0.9177
2026-02-27 08:27:45,167 - INFO - [Metrics for 'Defect'] | Precision: 0.8978 | Recall: 0.9231 | F1: 0.9103
2026-02-27 08:27:45,170 - INFO - --------------------------------------------------
2026-02-27 08:27:45,170 - INFO - [LR]    [39/90] | Learning Rate: 0.000659
2026-02-27 08:35:13,750 - INFO - [Train] [39/90] | Loss: 0.3389 | Train Acc: 91.46%
2026-02-27 08:35:52,915 - INFO - [Valid] [39/90] | Loss: 0.3401 | Val Acc: 91.34%
2026-02-27 08:35:53,092 - INFO - [Metrics for 'Normal'] | Precision: 0.9378 | Recall: 0.8954 | F1: 0.9161
2026-02-27 08:35:53,092 - INFO - [Metrics for 'Defect'] | Precision: 0.8886 | Recall: 0.9336 | F1: 0.9105
2026-02-27 08:35:53,098 - INFO - [Best Model Saved] (val loss: 0.3401) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 08:35:53,098 - INFO - --------------------------------------------------
2026-02-27 08:35:53,098 - INFO - [LR]    [40/90] | Learning Rate: 0.000644
2026-02-27 08:43:21,683 - INFO - [Train] [40/90] | Loss: 0.3385 | Train Acc: 91.53%
2026-02-27 08:44:00,796 - INFO - [Valid] [40/90] | Loss: 0.3415 | Val Acc: 91.43%
2026-02-27 08:44:00,943 - INFO - [Metrics for 'Normal'] | Precision: 0.9305 | Recall: 0.9055 | F1: 0.9178
2026-02-27 08:44:00,944 - INFO - [Metrics for 'Defect'] | Precision: 0.8973 | Recall: 0.9243 | F1: 0.9106
2026-02-27 08:44:00,945 - INFO - --------------------------------------------------
2026-02-27 08:44:00,945 - INFO - [LR]    [41/90] | Learning Rate: 0.000628
2026-02-27 08:51:29,417 - INFO - [Train] [41/90] | Loss: 0.3382 | Train Acc: 91.54%
2026-02-27 08:52:08,957 - INFO - [Valid] [41/90] | Loss: 0.3459 | Val Acc: 91.12%
2026-02-27 08:52:09,103 - INFO - [Metrics for 'Normal'] | Precision: 0.9417 | Recall: 0.8867 | F1: 0.9134
2026-02-27 08:52:09,103 - INFO - [Metrics for 'Defect'] | Precision: 0.8810 | Recall: 0.9385 | F1: 0.9088
2026-02-27 08:52:09,105 - INFO - --------------------------------------------------
2026-02-27 08:52:09,105 - INFO - [LR]    [42/90] | Learning Rate: 0.000613
2026-02-27 08:59:38,979 - INFO - [Train] [42/90] | Loss: 0.3375 | Train Acc: 91.56%
2026-02-27 09:00:18,277 - INFO - [Valid] [42/90] | Loss: 0.3388 | Val Acc: 91.55%
2026-02-27 09:00:18,424 - INFO - [Metrics for 'Normal'] | Precision: 0.9291 | Recall: 0.9095 | F1: 0.9192
2026-02-27 09:00:18,424 - INFO - [Metrics for 'Defect'] | Precision: 0.9010 | Recall: 0.9223 | F1: 0.9115
2026-02-27 09:00:18,430 - INFO - [Best Model Saved] (val loss: 0.3388) -> 'log/Sewer_ML/main_20260227_031923_grid7_patch7_layer6_head4/best_model.pth'
2026-02-27 09:00:18,430 - INFO - --------------------------------------------------
2026-02-27 09:00:18,430 - INFO - [LR]    [43/90] | Learning Rate: 0.000597
2026-02-27 09:07:47,112 - INFO - [Train] [43/90] | Loss: 0.3371 | Train Acc: 91.59%
2026-02-27 09:08:26,976 - INFO - [Valid] [43/90] | Loss: 0.3440 | Val Acc: 91.15%
2026-02-27 09:08:27,124 - INFO - [Metrics for 'Normal'] | Precision: 0.9408 | Recall: 0.8884 | F1: 0.9138
2026-02-27 09:08:27,124 - INFO - [Metrics for 'Defect'] | Precision: 0.8824 | Recall: 0.9374 | F1: 0.9091
2026-02-27 09:08:27,126 - INFO - --------------------------------------------------
2026-02-27 09:08:27,126 - INFO - [LR]    [44/90] | Learning Rate: 0.000581
